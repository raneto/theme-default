window.CodeMirror=function(){"use strict";var i,f=/gecko\/\d/i.test(navigator.userAgent),w=/MSIE \d/.test(navigator.userAgent),U=w&&(null==document.documentMode||document.documentMode<8),C=w&&(null==document.documentMode||document.documentMode<9),L=/WebKit\//.test(navigator.userAgent),o=L&&/Qt\/\d+\.\d+/.test(navigator.userAgent),l=/Chrome\//.test(navigator.userAgent),h=/Opera\//.test(navigator.userAgent),m=/Apple Computer/.test(navigator.vendor),y=/KHTML\//.test(navigator.userAgent),s=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),a=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),x=/PhantomJS/.test(navigator.userAgent),j=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),X=j||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),q=j||/Mac/.test(navigator.platform),c=/windows/i.test(navigator.platform),e=h&&navigator.userAgent.match(/Version\/(\d*\.\d*)/),Y=((e=e&&Number(e[1]))&&15<=e&&(L=!(h=!1)),q&&(o||h&&(null==e||e<12.11))),Z=f||w&&!C,Q=!1,J=!1;function d(e,r){if(!(this instanceof d))return new d(e,r);for(var t in this.options=r=r||{},Vt)!r.hasOwnProperty(t)&&Vt.hasOwnProperty(t)&&(r[t]=Vt[t]);ce(r);var n,i,o="string"==typeof r.value?0:r.value.first,e=this.display=function(e,t){var r={},n=r.input=_("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;");L?n.style.width="1000px":n.setAttribute("wrap","off");j&&(n.style.border="1px solid black");n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck","false"),r.inputDiv=_("div",[n],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),r.scrollbarH=_("div",[_("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),r.scrollbarV=_("div",[_("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),r.scrollbarFiller=_("div",null,"CodeMirror-scrollbar-filler"),r.gutterFiller=_("div",null,"CodeMirror-gutter-filler"),r.lineDiv=_("div",null,"CodeMirror-code"),r.selectionDiv=_("div",null,null,"position: relative; z-index: 1"),r.cursor=_("div"," ","CodeMirror-cursor"),r.otherCursor=_("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"),r.measure=_("div",null,"CodeMirror-measure"),r.lineSpace=_("div",[r.measure,r.selectionDiv,r.lineDiv,r.cursor,r.otherCursor],null,"position: relative; outline: none"),r.mover=_("div",[_("div",[r.lineSpace],"CodeMirror-lines")],null,"position: relative"),r.sizer=_("div",[r.mover],"CodeMirror-sizer"),r.heightForcer=_("div",null,null,"position: absolute; height: "+un+"px; width: 1px;"),r.gutters=_("div",null,"CodeMirror-gutters"),r.lineGutter=null,r.scroller=_("div",[r.sizer,r.heightForcer,r.gutters],"CodeMirror-scroll"),r.scroller.setAttribute("tabIndex","-1"),r.wrapper=_("div",[r.inputDiv,r.scrollbarH,r.scrollbarV,r.scrollbarFiller,r.gutterFiller,r.scroller],"CodeMirror"),U&&(r.gutters.style.zIndex=-1,r.scroller.style.paddingRight=0);e.appendChild?e.appendChild(r.wrapper):e(r.wrapper);j&&(n.style.width="0px");L||(r.scroller.draggable=!0);y?(r.inputDiv.style.height="1px",r.inputDiv.style.position="absolute"):U&&(r.scrollbarH.style.minWidth=r.scrollbarV.style.minWidth="18px");return r.viewOffset=r.lastSizeC=0,r.showingFrom=r.showingTo=t,r.lineNumWidth=r.lineNumInnerWidth=r.lineNumChars=null,r.prevInput="",r.alignWidgets=!1,r.pollingFast=!1,r.poll=new hn,r.cachedCharWidth=r.cachedTextHeight=null,r.measureLineCache=[],r.measureLineCachePos=0,r.inaccurateSelection=!1,r.maxLine=null,r.maxLineLength=0,r.maxLineChanged=!1,r.wheelDX=r.wheelDY=r.wheelStartX=r.wheelStartY=null,r}(e,o),o=(le(e.wrapper.CodeMirror=this),r.autofocus&&!X&&M(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,draggingText:!1,highlight:new hn},ie(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),r.value),l=(S(this,Br)(this,o="string"==typeof o?new p(r.value,r.mode):o),w&&setTimeout($(Xe,this,!0),20),this),s=l.display;function a(){l.state.focused&&setTimeout($(M,l),0)}function c(){null==i&&(i=setTimeout(function(){i=null,s.cachedCharWidth=s.cachedTextHeight=Tn=null,Ae(l),Ve(l,$(b,l))},100))}function u(e){R(l,e)||l.options.onDragEvent&&l.options.onDragEvent(l,Jr(e))||tn(e)}function f(){s.inaccurateSelection&&(s.prevInput="",s.inaccurateSelection=!1,s.input.value=l.getSelection(),mn(s.input))}P(s.scroller,"mousedown",S(l,Qe)),P(s.scroller,"dblclick",w?S(l,function(e){var t;R(l,e)||!(t=Ze(l,e))||Je(l,e)||Ye(l.display,e)||(I(e),e=$t(E(l.doc,t.line).text,t),D(l.doc,e.from,e.to))}):function(e){R(l,e)||I(e)}),P(s.lineSpace,"selectstart",function(e){Ye(s,e)||I(e)}),Z||P(s.scroller,"contextmenu",function(e){mt(l,e)}),P(s.scroller,"scroll",function(){s.scroller.clientHeight&&(rt(l,s.scroller.scrollTop),nt(l,s.scroller.scrollLeft,!0),g(l,"scroll",l))}),P(s.scrollbarV,"scroll",function(){s.scroller.clientHeight&&rt(l,s.scrollbarV.scrollTop)}),P(s.scrollbarH,"scroll",function(){s.scroller.clientHeight&&nt(l,s.scrollbarH.scrollLeft)}),P(s.scroller,"mousewheel",function(e){lt(l,e)}),P(s.scroller,"DOMMouseScroll",function(e){lt(l,e)}),P(s.scrollbarH,"mousedown",a),P(s.scrollbarV,"mousedown",a),P(s.wrapper,"scroll",function(){s.wrapper.scrollTop=s.wrapper.scrollLeft=0}),P(window,"resize",c),setTimeout(function e(){for(var t=s.wrapper.parentNode;t&&t!=document.body;t=t.parentNode);t?setTimeout(e,5e3):F(window,"resize",c)},5e3),P(s.input,"keyup",S(l,function(e){R(l,e)||l.options.onKeyEvent&&l.options.onKeyEvent(l,Jr(e))||16==e.keyCode&&(l.doc.sel.shift=!1)})),P(s.input,"input",$(Ue,l)),P(s.input,"keydown",S(l,ht)),P(s.input,"keypress",S(l,dt)),P(s.input,"focus",$(pt,l)),P(s.input,"blur",$(gt,l)),l.options.dragDrop&&(P(s.scroller,"dragstart",function(e){var t,r;t=l,e=e,w&&(!t.state.draggingText||+new Date-et<100)?tn(e):R(t,e)||Ye(t.display,e)||(r=t.getSelection(),e.dataTransfer.setData("Text",r),e.dataTransfer.setDragImage&&!m&&(r=_("img",null,null,"position: fixed; left: 0; top: 0;"),h&&(r.width=r.height=1,t.display.wrapper.appendChild(r),r._top=r.offsetTop),e.dataTransfer.setDragImage(r,0,0),h)&&r.parentNode.removeChild(r))}),P(s.scroller,"dragenter",u),P(s.scroller,"dragover",u),P(s.scroller,"drop",S(l,tt))),P(s.scroller,"paste",function(e){Ye(s,e)||(M(l),Ue(l))}),P(s.input,"paste",function(){l.state.pasteIncoming=!0,Ue(l)}),P(s.input,"cut",f),P(s.input,"copy",f),y&&P(s.sizer,"mouseup",function(){document.activeElement==s.input&&s.input.blur(),M(l)});try{n=document.activeElement==e.input}catch(e){}n||r.autofocus&&!X?setTimeout($(pt,this),20):gt(this),S(this,function(){for(var e in _t)_t.propertyIsEnumerable(e)&&_t[e](this,r[e],Kt);for(var t=0;t<qt.length;++t)qt[t](this)})()}function ee(e){e.doc.mode=d.getMode(e.options,e.doc.modeOption),e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,be(e,100),e.state.modeGen++,e.curOp&&b(e)}function te(t){var r=Ie(t.display),n=t.options.lineWrapping,i=n&&Math.max(5,t.display.scroller.clientWidth/Pe(t.display)-3);return function(e){return pr(t.doc,e)?0:n?(Math.ceil(e.text.length/i)||1)*r:r}}function re(e){var t=e.doc,r=te(e);t.iter(function(e){var t=r(e);t!=e.height&&O(e,t)})}function ne(e){var t=n[e.options.keyMap],r=t.style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(r?" cm-keymap-"+r:""),e.state.disableInput=t.disableInput}function ie(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Ae(e)}function oe(e){le(e),b(e),setTimeout(function(){he(e)},20)}function le(e){var t=e.display.gutters,r=e.options.gutters;Sn(t);for(var n=0;n<r.length;++n){var i=r[n],o=t.appendChild(_("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&((e.display.lineGutter=o).style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=n?"":"none"}function se(e,t){if(0==t.height)return 0;for(var r,n=t.text.length,i=t;r=hr(i);){i=E(e,(o=r.find()).from.line);n+=o.from.ch-o.to.ch}for(i=t;r=dr(i);)var o=r.find(),n=(n-=i.text.length-o.from.ch)+((i=E(e,o.to.line)).text.length-o.to.ch);return n}function ae(e){var r=e.display,n=e.doc;r.maxLine=E(n,n.first),r.maxLineLength=se(n,r.maxLine),r.maxLineChanged=!0,n.iter(function(e){var t=se(n,e);t>r.maxLineLength&&(r.maxLineLength=t,r.maxLine=e)})}function ce(e){for(var t=!1,r=0;r<e.gutters.length;++r)"CodeMirror-linenumbers"==e.gutters[r]&&(e.lineNumbers?t=!0:e.gutters.splice(r--,1));!t&&e.lineNumbers&&e.gutters.push("CodeMirror-linenumbers")}function ue(e){var t=e.display,r=e.doc.height+ke(t),r=(t.sizer.style.minHeight=t.heightForcer.style.top=r+"px",t.gutters.style.height=Math.max(r,t.scroller.clientHeight-un)+"px",Math.max(r,t.scroller.scrollHeight)),n=t.scroller.scrollWidth>t.scroller.clientWidth+1,i=r>t.scroller.clientHeight+1;i?(t.scrollbarV.style.display="block",t.scrollbarV.style.bottom=n?Dn(t.measure)+"px":"0",t.scrollbarV.firstChild.style.height=r-t.scroller.clientHeight+t.scrollbarV.clientHeight+"px"):t.scrollbarV.style.display="",n?(t.scrollbarH.style.display="block",t.scrollbarH.style.right=i?Dn(t.measure)+"px":"0",t.scrollbarH.firstChild.style.width=t.scroller.scrollWidth-t.scroller.clientWidth+t.scrollbarH.clientWidth+"px"):t.scrollbarH.style.display="",n&&i?(t.scrollbarFiller.style.display="block",t.scrollbarFiller.style.height=t.scrollbarFiller.style.width=Dn(t.measure)+"px"):t.scrollbarFiller.style.display="",n&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(t.gutterFiller.style.display="block",t.gutterFiller.style.height=Dn(t.measure)+"px",t.gutterFiller.style.width=t.gutters.offsetWidth+"px"):t.gutterFiller.style.display="",s&&0===Dn(t.measure)&&(t.scrollbarV.style.minWidth=t.scrollbarH.style.minHeight=a?"18px":"12px")}function fe(e,t,r){var n=e.scroller.scrollTop,i=e.wrapper.clientHeight,r=("number"==typeof r?n=r:r&&(n=r.top,i=r.bottom-r.top),n=Math.floor(n-Le(e)),Math.ceil(n+i));return{from:$r(t,n),to:$r(t,r)}}function he(e){var t=e.display;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var r=pe(t)-t.scroller.scrollLeft+e.doc.scrollLeft,n=t.gutters.offsetWidth,i=r+"px",o=t.lineDiv.firstChild;o;o=o.nextSibling)if(o.alignable)for(var l=0,s=o.alignable;l<s.length;++l)s[l].style.left=i;e.options.fixedGutter&&(t.gutters.style.left=r+n+"px")}}function de(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function pe(e){return K(e.scroller).left-K(e.sizer).left}function ge(e,t,r,n){for(var i,o=e.display.showingFrom,l=e.display.showingTo,s=fe(e.display,e.doc,r);function(e,t,r,n){var i=e.display,o=e.doc;if(i.wrapper.clientWidth){if(!(!n&&0==t.length&&r.from>i.showingFrom&&r.to<i.showingTo)){!function(e){var t,r,n;if(e.options.lineNumbers)return t=e.doc,t=de(e.options,t.first+t.size-1),e=e.display,t.length!=e.lineNumChars?(r=(n=e.measure.appendChild(_("div",[_("div",t)],"CodeMirror-linenumber CodeMirror-gutter-elt"))).firstChild.offsetWidth,n=n.offsetWidth-r,e.lineGutter.style.width="",e.lineNumInnerWidth=Math.max(r,e.lineGutter.offsetWidth-n),e.lineNumWidth=e.lineNumInnerWidth+n,e.lineNumChars=e.lineNumInnerWidth?t.length:-1,e.lineGutter.style.width=e.lineNumWidth+"px",1):void 0}(e)||(t=[{from:o.first,to:o.first+o.size}]);var l=i.sizer.style.marginLeft=i.gutters.offsetWidth+"px",s=(i.scrollbarH.style.left=e.options.fixedGutter?l:"0",1/0);if(e.options.lineNumbers)for(var a=0;a<t.length;++a)if(t[a].diff){s=t[a].from;break}var c=o.first+o.size,u=Math.max(r.from-e.options.viewportMargin,o.first),f=Math.min(c,r.to+e.options.viewportMargin);if(i.showingFrom<u&&u-i.showingFrom<20&&(u=Math.max(o.first,i.showingFrom)),i.showingTo>f&&i.showingTo-f<20&&(f=Math.min(c,i.showingTo)),J)for(u=v(W(o,E(o,u)));f<c&&pr(o,E(o,f));)++f;var h=[{from:Math.max(i.showingFrom,o.first),to:Math.min(i.showingTo,c)}];if(h=h[0].from>=h[0].to?[]:function(e,t){for(var r=0,n=t.length||0;r<n;++r){for(var i=t[r],o=[],l=i.diff||0,s=0,a=e.length;s<a;++s){var c=e[s];i.to<=c.from&&i.diff?o.push({from:c.from+l,to:c.to+l}):i.to<=c.from||i.from>=c.to?o.push(c):(i.from>c.from&&o.push({from:c.from,to:i.from}),i.to<c.to&&o.push({from:i.to+l,to:c.to+l}))}e=o}return e}(h,t),J)for(a=0;a<h.length;++a)for(var d=h[a];p=dr(E(o,d.to-1));){var p=p.find().from.line;if(!(p>d.from)){h.splice(a--,1);break}d.to=p}for(var g=0,a=0;a<h.length;++a)(d=h[a]).from<u&&(d.from=u),d.to>f&&(d.to=f),d.from>=d.to?h.splice(a--,1):g+=d.to-d.from;if(n||g!=f-u||u!=i.showingFrom||f!=i.showingTo){h.sort(function(e,t){return e.from-t.from});try{var m=document.activeElement}catch(e){}return g<.7*(f-u)&&(i.lineDiv.style.display="none"),function(c,e,t,u,f){var h=function(e){for(var t=e.display,r={},n={},i=t.gutters.firstChild,o=0;i;i=i.nextSibling,++o)r[e.options.gutters[o]]=i.offsetLeft,n[e.options.gutters[o]]=i.offsetWidth;return{fixedPos:pe(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:r,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}(c),r=c.display,d=c.options.lineNumbers;u.length||L&&c.display.currentWheelTarget||Sn(r.lineDiv);var p=r.lineDiv,g=p.firstChild;function m(e){var t=e.nextSibling;return L&&q&&c.display.currentWheelTarget==e?(e.style.display="none",e.lineObj=null):e.parentNode.removeChild(e),t}var v=u.shift(),y=e;c.doc.iter(e,t,function(e){if(v&&v.to==y&&(v=u.shift()),pr(c.doc,e)){if(0!=e.height&&O(e,0),e.widgets&&g.previousSibling)for(var t=0;t<e.widgets.length;++t){var r,n,i=e.widgets[t];i.showIfHidden&&(r=g.previousSibling,/pre/i.test(r.nodeName)&&(n=_("div",null,null,"position: relative"),r.parentNode.replaceChild(n,r),n.appendChild(r),r=n),n=r.appendChild(_("div",[i.node],"CodeMirror-linewidget")),i.handleMouseEvents||(n.ignoreEvents=!0),ve(i,n,r,h))}}else if(v&&v.from<=y&&v.to>y){for(;g.lineObj!=e;)g=m(g);d&&f<=y&&g.lineNumber&&Mn(g.lineNumber,de(c.options,y)),g=g.nextSibling}else{if(e.widgets)for(var o,l=0,s=g;s&&l<20;++l,s=s.nextSibling)if(s.lineObj==e&&/div/i.test(s.nodeName)){o=s;break}var a=function(e,t,r,n,i){var o,l=Tr(e,t),s=t.gutterMarkers,a=e.display;if(!(e.options.lineNumbers||s||t.bgClass||t.wrapClass||t.widgets))return l;if(i){for(var c,u=!(i.alignable=null),f=0,h=null,d=i.firstChild;d;d=c)if(c=d.nextSibling,/\bCodeMirror-linewidget\b/.test(d.className)){for(var p=0;p<t.widgets.length;++p)if((b=t.widgets[p]).node==d.firstChild){b.above||(h=h||d),ve(b,d,i,n),++f;break}if(p==t.widgets.length){u=!1;break}}else i.removeChild(d);i.insertBefore(l,h),u&&f==t.widgets.length&&((o=i).className=t.wrapClass||"")}o||(o=_("div",null,t.wrapClass,"position: relative")).appendChild(l);t.bgClass&&o.insertBefore(_("div",null,t.bgClass+" CodeMirror-linebackground"),o.firstChild);if(e.options.lineNumbers||s){var g=o.insertBefore(_("div",null,null,"position: absolute; left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px"),o.firstChild);if(e.options.fixedGutter&&(o.alignable||(o.alignable=[])).push(g),!e.options.lineNumbers||s&&s["CodeMirror-linenumbers"]||(o.lineNumber=g.appendChild(_("div",de(e.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+a.lineNumInnerWidth+"px"))),s)for(var m=0;m<e.options.gutters.length;++m){var v=e.options.gutters[m],y=s.hasOwnProperty(v)&&s[v];y&&g.appendChild(_("div",[y],"CodeMirror-gutter-elt","left: "+n.gutterLeft[v]+"px; width: "+n.gutterWidth[v]+"px"))}}U&&(o.style.zIndex=2);if(t.widgets&&o!=i)for(var p=0,x=t.widgets;p<x.length;++p){var b,w=_("div",[(b=x[p]).node],"CodeMirror-linewidget");b.handleMouseEvents||(w.ignoreEvents=!0),ve(b,w,o,n),b.above?o.insertBefore(w,e.options.lineNumbers&&0!=t.height?g:l):o.appendChild(w),B(b,"redraw")}return o}(c,e,y,h,o);if(a!=o)p.insertBefore(a,g);else{for(;g!=o;)g=m(g);g=g.nextSibling}a.lineObj=e}++y});for(;g;)g=m(g)}(e,u,f,h,s),i.lineDiv.style.display="",m&&document.activeElement!=m&&m.offsetHeight&&m.focus(),u==i.showingFrom&&f==i.showingTo&&i.lastSizeC==i.wrapper.clientHeight||(i.lastSizeC=i.wrapper.clientHeight,be(e,400)),i.showingFrom=u,i.showingTo=f,function(e){for(var t,r=e.display,n=r.lineDiv.offsetTop,i=r.lineDiv.firstChild;i;i=i.nextSibling)if(i.lineObj){U?(o=i.offsetTop+i.offsetHeight,t=o-n,n=o):(o=K(i),t=o.bottom-o.top);var o,l=i.lineObj.height-t;if(t<2&&(t=Ie(r)),.001<l||l<-.001){O(i.lineObj,t);var s=i.lineObj.widgets;if(s)for(var a=0;a<s.length;++a)s[a].height=s[a].node.offsetHeight}}}(e),me(e),1}me(e)}}else i.showingFrom=i.showingTo=o.first,i.viewOffset=0}(e,t,s,n)&&(i=!(n=!1),ye(e),ue(e),r=r&&Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,"number"==typeof r?r:r.top),!((s=fe(e.display,e.doc,r)).from>=e.display.showingFrom&&s.to<=e.display.showingTo));)t=[];return i&&(B(e,"update",e),e.display.showingFrom==o&&e.display.showingTo==l||B(e,"viewportChange",e,e.display.showingFrom,e.display.showingTo)),i}function me(e){var t=e.display.viewOffset=_r(e,E(e.doc,e.display.showingFrom));e.display.mover.style.top=t+"px"}function ve(e,t,r,n){e.noHScroll&&((r.alignable||(r.alignable=[])).push(t),r=n.wrapperWidth,t.style.left=n.fixedPos+"px",e.coverGutter||(r-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=r+"px"),e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}function ye(e){var t,r=e.display,n=A(e.doc.sel.from,e.doc.sel.to);if(n||e.options.showCursorWhenSelecting?(i=(l=e).display,s=k(l,l.doc.sel.head,"div"),i.cursor.style.left=s.left+"px",i.cursor.style.top=s.top+"px",i.cursor.style.height=Math.max(0,s.bottom-s.top)*l.options.cursorHeight+"px",i.cursor.style.display="",s.other?(i.otherCursor.style.display="",i.otherCursor.style.left=s.other.left+"px",i.otherCursor.style.top=s.other.top+"px",i.otherCursor.style.height=.85*(s.other.bottom-s.other.top)+"px"):i.otherCursor.style.display="none"):r.cursor.style.display=r.otherCursor.style.display="none",n)r.selectionDiv.style.display="none";else{var i,o=e,l=o.display,d=o.doc,s=o.doc.sel,a=document.createDocumentFragment(),p=l.lineSpace.offsetWidth,g=function(e){return V(e.measure,_("pre",null,null,"text-align: left")).appendChild(_("span","x")).offsetLeft}(o.display);function m(e,t,r,n){a.appendChild(_("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+(t=t<0?0:t)+"px; width: "+(null==r?p-e:r)+"px; height: "+(n-t)+"px"))}function c(r,s,a){var c,u,n=E(d,r),f=n.text.length;function h(e,t){return Ee(o,T(r,e),"div",n,t)}return function(e,t,r,n){if(!e)return n(t,r,"ltr");for(var i=!1,o=0;o<e.length;++o){var l=e[o];(l.from<r&&l.to>t||t==r&&l.to==t)&&(n(Math.max(l.from,t),Math.min(l.to,r),1==l.level?"rtl":"ltr"),i=!0)}i||n(t,r,"ltr")}(z(n),s||0,null==a?f:a,function(e,t,r){var n,i,o,l=h(e,"left");e==t?n=i=(o=l).left:(o=h(t-1,"right"),"rtl"==r&&(r=l,l=o,o=r),n=l.left,i=o.right),null==s&&0==e&&(n=g),3<o.top-l.top&&(m(n,l.top,null,l.bottom),n=g,l.bottom<o.top)&&m(n,l.bottom,null,o.top),null==a&&t==f&&(i=p),(!c||l.top<c.top||l.top==c.top&&l.left<c.left)&&(c=l),(!u||o.bottom>u.bottom||o.bottom==u.bottom&&o.right>u.right)&&(u=o),m(n=n<g+1?g:n,o.top,i-n,o.bottom)}),{start:c,end:u}}s.from.line==s.to.line?c(s.from.line,s.from.ch,s.to.ch):(i=E(d,s.from.line),n=E(d,s.to.line),n=W(d,i)==W(d,n),i=c(s.from.line,s.from.ch,n?i.text.length:null).end,s=c(s.to.line,n?0:null,s.to.ch).start,n&&(i.top<s.top-2?(m(i.right,i.top,null,i.bottom),m(g,s.top,s.left,s.bottom)):m(i.right,i.top,s.left-i.right,i.bottom)),i.bottom<s.top&&m(g,i.bottom,null,s.top)),V(l.selectionDiv,a),l.selectionDiv.style.display=""}e.options.moveInputWithCursor&&(n=k(e,e.doc.sel.head,"div"),e=K(r.wrapper),t=K(r.lineDiv),r.inputDiv.style.top=Math.max(0,Math.min(r.wrapper.clientHeight-10,n.top+t.top-e.top))+"px",r.inputDiv.style.left=Math.max(0,Math.min(r.wrapper.clientWidth-10,n.left+t.left-e.left))+"px")}function xe(e){var t,r;e.state.focused&&(t=e.display,clearInterval(t.blinker),r=!0,t.cursor.style.visibility=t.otherCursor.style.visibility="",t.blinker=setInterval(function(){t.cursor.style.visibility=t.otherCursor.style.visibility=(r=!r)?"":"hidden"},e.options.cursorBlinkRate))}function be(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.showingTo&&e.state.highlight.set(t,$(we,e))}function we(i){var o,l,s,a,c=i.doc;c.frontier<c.first&&(c.frontier=c.first),c.frontier>=i.display.showingTo||(o=+new Date+i.options.workTime,l=Zt(c.mode,Ce(i,c.frontier)),s=[],c.iter(c.frontier,Math.min(c.first+c.size,i.display.showingTo+500),function(e){if(c.frontier>=i.display.showingFrom){for(var t=e.styles,r=(e.styles=Cr(i,e,l),!t||t.length!=e.styles.length),n=0;!r&&n<t.length;++n)r=t[n]!=e.styles[n];r&&(a&&a.end==c.frontier?a.end++:s.push(a={start:c.frontier,end:c.frontier+1})),e.stateAfter=Zt(c.mode,l)}else kr(i,e,l),e.stateAfter=c.frontier%5==0?Zt(c.mode,l):null;if(++c.frontier,+new Date>o)return be(i,i.options.workDelay),!0}),s.length&&S(i,function(){for(var e=0;e<s.length;++e)b(this,s[e].start,s[e].end)})())}function Ce(r,n,e){var i,o,l=r.doc,s=r.display;return!l.mode.startState||(i=function(e,t,r){for(var n,i,o=e.doc,l=t,s=t-100;s<l;--l){if(l<=o.first)return o.first;var a=E(o,l-1);if(a.stateAfter&&(!r||l<=o.frontier))return l;a=dn(a.text,null,e.options.tabSize);(null==i||a<n)&&(i=l-1,n=a)}return i}(r,n,e),o=(o=i>l.first&&E(l,i-1).stateAfter)?Zt(l.mode,o):Qt(l.mode),l.iter(i,n,function(e){kr(r,e,o);var t=i==n-1||i%5==0||i>=s.showingFrom&&i<s.showingTo;e.stateAfter=t?Zt(l.mode,o):null,++i}),o)}function Le(e){return e.lineSpace.offsetTop}function ke(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Se(e,t,r,n,i){var o=-1;n=n||Te(e,t);for(var l=r;;l+=o){var s=n[l];if(s)break;o<0&&0==l&&(o=1)}return"left"==(i=r<l?"left":l<r?"right":i)&&s.leftSide?s=s.leftSide:"right"==i&&s.rightSide&&(s=s.rightSide),{left:l<r?s.right:s.left,right:r<l?s.left:s.right,top:s.top,bottom:s.bottom}}function Me(e,t){for(var r=e.display.measureLineCache,n=0;n<r.length;++n){var i=r[n];if(i.text==t.text&&i.markedSpans==t.markedSpans&&e.display.scroller.clientWidth==i.width&&i.classes==t.textClass+"|"+t.bgClass+"|"+t.wrapClass)return i}}function Te(e,t){var r,n=Me(e,t);return n?n.measure:(n=function(e,t){var r=e.display,n=bn(t.text.length),i=Tr(e,t,n,!0);if(w&&!U&&!e.options.lineWrapping&&100<i.childNodes.length){for(var o=document.createDocumentFragment(),l=i.childNodes.length,s=0,a=Math.ceil(l/10);s<a;++s){for(var c=_("div",null,null,"display: inline-block"),u=0;u<10&&l;++u)c.appendChild(i.firstChild),--l;o.appendChild(c)}i.appendChild(o)}V(r.measure,i);var f=K(r.lineDiv),h=[],d=bn(t.text.length),p=i.offsetHeight;C&&r.measure.first!=i&&V(r.measure,i);function g(e){var t=e.top-f.top,r=e.bottom-f.top;p<r&&(r=p),t<0&&(t=0);for(var n=h.length-2;0<=n;n-=2){var i=h[n],o=h[n+1];if(!(r<i||o<t)&&(i<=t&&r<=o||t<=i&&o<=r||Math.min(r,o)-Math.max(t,i)>=r-t>>1)){h[n]=Math.min(t,i),h[n+1]=Math.max(r,o);break}}return n<0&&(n=h.length,h.push(t,r)),{left:e.left-f.left,right:e.right-f.left,top:n,bottom:null}}function m(e){e.bottom=h[e.top+1],e.top=h[e.top]}for(s=0;s<n.length;++s){var v,y,x;(b=n[s])&&(v=b,y=null,/\bCodeMirror-widget\b/.test(b.className)&&b.getClientRects&&1<(x=(v=1==b.firstChild.nodeType?b.firstChild:v).getClientRects()).length&&((y=d[s]=g(x[0])).rightSide=g(x[x.length-1])),y=y||(d[s]=g(K(v))),b.measureRight&&(y.right=K(b.measureRight).left),b.leftSide)&&(y.leftSide=g(K(b.leftSide)))}for(var b,s=0;s<d.length;++s)(b=d[s])&&(m(b),b.leftSide&&m(b.leftSide),b.rightSide)&&m(b.rightSide);return d}(e,t),r=e.display.measureLineCache,t={text:t.text,width:e.display.scroller.clientWidth,markedSpans:t.markedSpans,measure:n,classes:t.textClass+"|"+t.bgClass+"|"+t.wrapClass},16==r.length?r[++e.display.measureLineCachePos%16]=t:r.push(t),n)}function Ae(e){e.display.measureLineCache.length=e.display.measureLineCachePos=0,e.display.cachedCharWidth=e.display.cachedTextHeight=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Ne(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function He(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function De(e,t,r,n){if(t.widgets)for(var i=0;i<t.widgets.length;++i){var o;t.widgets[i].above&&(o=xr(t.widgets[i]),r.top+=o,r.bottom+=o)}var l;return"line"!=n&&(n=n||"local",l=_r(e,t),"local"==n?l+=Le(e.display):l-=e.display.viewOffset,"page"!=n&&"window"!=n||(l+=(e=K(e.display.lineSpace)).top+("window"==n?0:He()),e=e.left+("window"==n?0:Ne()),r.left+=e,r.right+=e),r.top+=l,r.bottom+=l),r}function We(e,t,r){var n;return"div"==r?t:(n=t.left,t=t.top,"page"==r?(n-=Ne(),t-=He()):"local"!=r&&r||(n+=(r=K(e.display.sizer)).left,t+=r.top),{left:n-(r=K(e.display.lineSpace)).left,top:t-r.top})}function Ee(e,t,r,n,i){return De(e,n=n||E(e.doc,t.line),Se(e,n,t.ch,null,i),r)}function k(r,e,n,i,o){function l(e,t){e=Se(r,i,e,o,t?"right":"left");return t?e.left=e.right:e.right=e.left,De(r,i,e,n)}function t(e,t){var r=a[t],n=r.level%2;return e==Fn(r)&&t&&r.level<a[t-1].level?(e=Bn(r=a[--t])-(r.level%2?0:1),n=!0):e==Bn(r)&&t<a.length-1&&r.level<a[t+1].level&&(e=Fn(r=a[++t])-r.level%2,n=!1),n&&e==r.to&&e>r.from?l(e-1):l(e,n)}i=i||E(r.doc,e.line),o=o||Te(r,i);var s,a=z(i),e=e.ch;return a?(s=t(e,_n(a,e)),null!=En&&(s.other=t(e,En)),s):l(e)}function Oe(e,t,r,n){e=new T(e,t);return e.xRel=n,r&&(e.outside=!0),e}function ze(e,t,r){var n=e.doc;if((r+=e.display.viewOffset)<0)return Oe(n.first,0,!0,-1);var i=$r(n,r),o=n.first+n.size-1;if(o<i)return Oe(n.first+n.size-1,E(n,o).text.length,!0,1);for(t<0&&(t=0);;){var l=E(n,i),s=function(t,r,n,e,i){var o=i-_r(t,r),l=!1,s=2*t.display.wrapper.clientWidth,a=Te(t,r);function c(e){e=k(t,T(n,e),"line",r,a);return l=!0,o>e.bottom?e.left-s:o<e.top?e.left+s:(l=!1,e.left)}var u=z(r),f=r.text.length,h=Rn(r),d=Gn(r),p=c(h),g=l,m=c(d),v=l;if(m<e)return Oe(n,d,v,1);for(;;){if(u?d==h||d==Kn(r,h,1):d-h<=1){for(var y=e<p||e-p<=m-e?h:d,x=e-(y==h?p:m);kn.test(r.text.charAt(y));)++y;return Oe(n,y,y==h?g:v,x<0?-1:x?1:0)}var b=Math.ceil(f/2),w=h+b;if(u){w=h;for(var C=0;C<b;++C)w=Kn(r,w,1)}x=c(w);e<x?(d=w,m=x,(v=l)&&(m+=1e3),f=b):(h=w,p=x,g=l,f-=b)}}(e,l,i,t,r),l=dr(l),a=l&&l.find();if(!l||!(s.ch>a.from.ch||s.ch==a.from.ch&&0<s.xRel))return s;i=a.to.line}}function Ie(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==i){i=_("pre");for(var t=0;t<49;++t)i.appendChild(document.createTextNode("x")),i.appendChild(_("br"));i.appendChild(document.createTextNode("x"))}V(e.measure,i);var r=i.offsetHeight/50;return 3<r&&(e.cachedTextHeight=r),Sn(e.measure),r||1}function Pe(e){var t,r;return null!=e.cachedCharWidth?e.cachedCharWidth:(t=_("span","x"),r=_("pre",[t]),V(e.measure,r),2<(r=t.offsetWidth)&&(e.cachedCharWidth=r),r||10)}var Fe,Be,Re=0;function Ge(e){e.curOp={changes:[],forceUpdate:!1,updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,cursorActivity:!1,updateMaxLine:!1,updateScrollPos:!1,id:++Re},ln++||(on=[])}function $e(e){var t,r,n,i,o=e.curOp,l=e.doc,s=e.display,a=(e.curOp=null,o.updateMaxLine&&ae(e),s.maxLineChanged&&!e.options.lineWrapping&&s.maxLine&&(r=function(e,t){var r=!1;if(t.markedSpans)for(var n=0;n<t.markedSpans;++n){var i=t.markedSpans[n];!i.collapsed||null!=i.to&&i.to!=t.text.length||(r=!0)}var o,l=!r&&Me(e,t);return l?Se(e,t,t.text.length,l.measure,"right").right:(o=(l=Tr(e,t,null,!0)).appendChild(Wn(e.display.measure)),V(e.display.measure,l),K(o).right-K(e.display.lineDiv).left)}(e,s.maxLine),s.sizer.style.minWidth=Math.max(0,r+3+un)+"px",s.maxLineChanged=!1,(r=Math.max(0,s.sizer.offsetLeft+s.sizer.offsetWidth-s.scroller.clientWidth))<l.scrollLeft)&&!o.updateScrollPos&&nt(e,Math.min(s.scroller.scrollLeft,r),!0),o.updateScrollPos?t=o.updateScrollPos:o.selectionChanged&&s.scroller.clientHeight&&(t=zt(e,(r=k(e,l.sel.head)).left,r.top,r.left,r.bottom)),(o.changes.length||o.forceUpdate||t&&null!=t.scrollTop)&&(n=ge(e,o.changes,t&&t.scrollTop,o.forceUpdate),e.display.scroller.offsetHeight)&&(e.doc.scrollTop=e.display.scroller.scrollTop),!n&&o.selectionChanged&&ye(e),o.updateScrollPos?(s.scroller.scrollTop=s.scrollbarV.scrollTop=l.scrollTop=t.scrollTop,s.scroller.scrollLeft=s.scrollbarH.scrollLeft=l.scrollLeft=t.scrollLeft,he(e),o.scrollToPos&&Ot(e,H(e.doc,o.scrollToPos),o.scrollToPosMargin)):t&&(n=Ot(r=e,r.doc.sel.head,r.options.cursorScrollMargin),r.state.focused)&&(r=r.display,s=K(r.sizer),l=null,n.top+s.top<0?l=!0:n.bottom+s.top>(window.innerHeight||document.documentElement.clientHeight)&&(l=!1),null==l||x||((s="none"==r.cursor.style.display)&&(r.cursor.style.display="",r.cursor.style.left=n.left+"px",r.cursor.style.top=n.top-r.viewOffset+"px"),r.cursor.scrollIntoView(l),s&&(r.cursor.style.display="none"))),o.selectionChanged&&xe(e),e.state.focused&&o.updateInput&&Xe(e,o.userSelChange),o.maybeHiddenMarkers),c=o.maybeUnhiddenMarkers;if(a)for(var u=0;u<a.length;++u)a[u].lines.length||g(a[u],"hide");if(c)for(u=0;u<c.length;++u)c[u].lines.length&&g(c[u],"unhide");if(--ln||(i=on,on=null),o.textChanged&&g(e,"change",e,o.textChanged),o.cursorActivity&&g(e,"cursorActivity",e),i)for(u=0;u<i.length;++u)i[u]()}function S(n,i){return function(){var e=n||this,t=!e.curOp;t&&Ge(e);try{var r=i.apply(e,arguments)}finally{t&&$e(e)}return r}}function _e(r){return function(){var e,t=this.cm&&!this.cm.curOp;t&&Ge(this.cm);try{e=r.apply(this,arguments)}finally{t&&$e(this.cm)}return e}}function Ve(e,t){var r,n=!e.curOp;n&&Ge(e);try{r=t()}finally{n&&$e(e)}return r}function b(e,t,r,n){null==t&&(t=e.doc.first),null==r&&(r=e.doc.first+e.doc.size),e.curOp.changes.push({from:t,to:r,diff:n})}function Ke(e){e.display.pollingFast||e.display.poll.set(e.options.pollInterval,function(){je(e),e.state.focused&&Ke(e)})}function Ue(t){var r=!1;t.display.pollingFast=!0,t.display.poll.set(20,function e(){je(t)||r?(t.display.pollingFast=!1,Ke(t)):(r=!0,t.display.poll.set(60,e))})}function je(e){var t=e.display.input,r=e.display.prevInput,n=e.doc,i=n.sel;if(!e.state.focused||zn(t)||qe(e)||e.state.disableInput)return!1;var o=t.value;if(o==r&&A(i.from,i.to))return!1;if(w&&!C&&e.display.inputHasSelection===o)return Xe(e,!0),!1;for(var l=!e.curOp,s=(l&&Ge(e),i.shift=!1,0),a=Math.min(r.length,o.length);s<a&&r.charCodeAt(s)==o.charCodeAt(s);)++s;var c=i.from,i=i.to,n=(s<r.length?c=T(c.line,c.ch-(r.length-s)):e.state.overwrite&&A(c,i)&&!e.state.pasteIncoming&&(i=T(i.line,Math.min(E(n,i.line).text.length,i.ch+(o.length-s)))),e.curOp.updateInput),c={from:c,to:i,text:On(o.slice(s)),origin:e.state.pasteIncoming?"paste":"+input"};return wt(e.doc,c,"end"),e.curOp.updateInput=n,B(e,"inputRead",e,c),1e3<o.length||-1<o.indexOf("\n")?t.value=e.display.prevInput="":e.display.prevInput=o,l&&$e(e),!(e.state.pasteIncoming=!1)}function Xe(e,t){var r,n,i=e.doc;A(i.sel.from,i.sel.to)?t&&(e.display.prevInput=e.display.input.value="",w)&&!C&&(e.display.inputHasSelection=null):(e.display.prevInput="",t=(n=In&&(100<i.sel.to.line-i.sel.from.line||1e3<(r=e.getSelection()).length))?"-":r||e.getSelection(),e.display.input.value=t,e.state.focused&&mn(e.display.input),w&&!C&&(e.display.inputHasSelection=t)),e.display.inaccurateSelection=n}function M(e){"nocursor"==e.options.readOnly||X&&document.activeElement==e.display.input||e.display.input.focus()}function qe(e){return e.options.readOnly||e.doc.cantEdit}function Ye(e,t){for(var r=rn(t);r!=e.wrapper;r=r.parentNode)if(!r||r.ignoreEvents||r.parentNode==e.sizer&&r!=e.mover)return 1}function Ze(e,t,r){var n=e.display;if(!r){r=rn(t);if(r==n.scrollbarH||r==n.scrollbarH.firstChild||r==n.scrollbarV||r==n.scrollbarV.firstChild||r==n.scrollbarFiller||r==n.gutterFiller)return null}var i,o,r=K(n.lineSpace);try{i=t.clientX,o=t.clientY}catch(t){return null}return ze(e,i-r.left,o-r.top)}function Qe(t){if(!R(this,t)){var l=this,s=l.display,a=l.doc,e=a.sel;if(e.shift=t.shiftKey,Ye(s,t))L||(s.scroller.draggable=!1,setTimeout(function(){s.scroller.draggable=!0},100));else if(!Je(l,t)){var r,c,n,i,u,o,f,h,d,p,g,m,v,y=Ze(l,t);switch(nn(t)){case 3:return void(Z&&mt.call(l,l,t));case 2:return y&&D(l.doc,y),setTimeout($(M,l),20),void I(t)}y?(l.state.focused||pt(l),r=+new Date,c="single",Be&&Be.time>r-400&&A(Be.pos,y)?(c="triple",I(t),setTimeout($(M,l),20),n=l,i=y.line,D(n.doc,T(i,0),H(n.doc,T(i+1,0)))):Fe&&Fe.time>r-400&&A(Fe.pos,y)?(c="double",Be={time:r,pos:y},I(t),n=$t(E(a,y.line).text,y),D(l.doc,n.from,n.to)):Fe={time:r,pos:y},u=y,!l.options.dragDrop||!Nn||qe(l)||A(e.from,e.to)||N(y,e.from)||N(e.to,y)||"single"!=c?(I(t),"single"==c&&D(l.doc,H(a,y)),f=e.from,h=e.to,d=y,p=K(s.wrapper),g=0,m=S(l,function(e){(w||nn(e)?x:b)(e)}),v=S(l,b),P(document,"mousemove",m),P(document,"mouseup",v)):(o=S(l,function(e){L&&(s.scroller.draggable=!1),l.state.draggingText=!1,F(document,"mouseup",o),F(s.scroller,"drop",o),Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)<10&&(I(e),D(l.doc,y),M(l))}),L&&(s.scroller.draggable=!0),l.state.draggingText=o,s.scroller.dragDrop&&s.scroller.dragDrop(),P(document,"mouseup",o),P(s.scroller,"drop",o))):rn(t)==s.scroller&&I(t)}}function x(e){var t,r,n,i=++g,o=Ze(l,e,!0);o&&(A(o,u)?(t=e.clientY<p.top?-20:e.clientY>p.bottom?20:0)&&setTimeout(S(l,function(){g==i&&(s.scroller.scrollTop+=t,x(e))}),50):(l.state.focused||pt(l),A(d,r=u=o)||(d=r,"single"==c?D(l.doc,H(a,y),r):(f=H(a,f),h=H(a,h),"double"==c?(n=$t(E(a,r.line).text,r),N(r,f)?D(l.doc,n.from,h):D(l.doc,f,n.to)):"triple"==c&&(N(r,f)?D(l.doc,h,H(a,T(r.line,0))):D(l.doc,f,H(a,T(r.line+1,0)))))),n=fe(s,a),(o.line>=n.to||o.line<n.from)&&setTimeout(S(l,function(){g==i&&x(e)}),150)))}function b(e){g=1/0,I(e),M(l),F(document,"mousemove",m),F(document,"mouseup",v)}}function Je(e,t){var r=e.display;try{var n=t.clientX,i=t.clientY}catch(t){return}if(!(n>=Math.floor(K(r.gutters).right))){if(I(t),an(e,"gutterClick")){var o=K(r.lineDiv);if(!(i>o.bottom)){i-=o.top-r.viewOffset;for(var l=0;l<e.options.gutters.length;++l){var s=r.gutters.childNodes[l];if(s&&K(s).right>=n){B(e,"gutterClick",e,$r(e.doc,i),e.options.gutters[l],t);break}}}}return 1}}var et=0;function tt(e){var n=this;if(!(R(n,e)||Ye(n.display,e)||n.options.onDragEvent&&n.options.onDragEvent(n,Jr(e)))){I(e),w&&(et=+new Date);var t,r,i=Ze(n,e,!0),o=e.dataTransfer.files;if(i&&!qe(n))if(o&&o.length&&window.FileReader&&window.File)for(var l=o.length,s=Array(l),a=0,c=0;c<l;++c)!function(e,t){var r=new FileReader;r.onload=function(){s[t]=r.result,++a==l&&(i=H(n.doc,i),wt(n.doc,{from:i,to:i,text:On(s.join("\n")),origin:"paste"},"around"))},r.readAsText(e)}(o[c],c);else if(!n.state.draggingText||N(i,n.doc.sel.from)||N(n.doc.sel.to,i))try{(s=e.dataTransfer.getData("Text"))&&(t=n.doc.sel.from,r=n.doc.sel.to,Dt(n.doc,i,i),n.state.draggingText&&Mt(n.doc,"",t,r,"paste"),n.replaceSelection(s,null,"paste"),M(n),pt(n))}catch(e){}else n.state.draggingText(e),setTimeout($(M,n),20)}}function rt(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,f||ge(e,[],t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbarV.scrollTop!=t&&(e.display.scrollbarV.scrollTop=t),f&&ge(e,[]),be(e,100))}function nt(e,t,r){(r?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,he(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t))}var it,ot=0,u=null;function lt(e,t){var r,n,i,o=t.wheelDeltaX,l=t.wheelDeltaY,s=(null==o&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(o=t.detail),null==l&&t.detail&&t.axis==t.VERTICAL_AXIS?l=t.detail:null==l&&(l=t.wheelDelta),e.display),a=s.scroller;if(o&&a.scrollWidth>a.clientWidth||l&&a.scrollHeight>a.clientHeight){if(l&&q&&L)for(var c=t.target;c!=a;c=c.parentNode)if(c.lineObj){e.display.currentWheelTarget=c;break}!o||f||h||null==u?(l&&null!=u&&(r=l*u,i=(n=e.doc.scrollTop)+s.wrapper.clientHeight,r<0?n=Math.max(0,n+r-50):i=Math.min(e.doc.height,i+r+50),ge(e,[],{top:n,bottom:i})),ot<20&&(null==s.wheelStartX?(s.wheelStartX=a.scrollLeft,s.wheelStartY=a.scrollTop,s.wheelDX=o,s.wheelDY=l,setTimeout(function(){var e,t;null!=s.wheelStartX&&(e=a.scrollLeft-s.wheelStartX,t=(t=a.scrollTop-s.wheelStartY)&&s.wheelDY&&t/s.wheelDY||e&&s.wheelDX&&e/s.wheelDX,s.wheelStartX=s.wheelStartY=null,t)&&(u=(u*ot+t)/(ot+1),++ot)},200)):(s.wheelDX+=o,s.wheelDY+=l))):(l&&rt(e,Math.max(0,Math.min(a.scrollTop+l*u,a.scrollHeight-a.clientHeight))),nt(e,Math.max(0,Math.min(a.scrollLeft+o*u,a.scrollWidth-a.clientWidth))),I(t),s.wheelStartX=null)}}function st(e,t,r){if("string"==typeof t&&!(t=Jt[t]))return!1;e.display.pollingFast&&je(e)&&(e.display.pollingFast=!1);var n=e.doc,i=n.sel.shift,o=!1;try{qe(e)&&(e.state.suppressEdits=!0),r&&(n.sel.shift=!1),o=t(e)!=fn}finally{n.sel.shift=i,e.state.suppressEdits=!1}return o}function at(e){var t=e.state.keyMaps.slice(0);return e.options.extraKeys&&t.push(e.options.extraKeys),t.push(e.options.keyMap),t}function ct(t,e){var r,n=er(t.options.keyMap),i=n.auto,o=(clearTimeout(it),i&&!rr(e)&&(it=setTimeout(function(){er(t.options.keyMap)==n&&(t.options.keyMap=i.call?i.call(null,t):i,ne(t))},50)),nr(e,!0)),l=!1;return!!o&&(r=at(t),(l=e.shiftKey?tr("Shift-"+o,r,function(e){return st(t,e,!0)})||tr(o,r,function(e){return!("string"==typeof e?!/^go[A-Z]/.test(e):!e.motion)&&st(t,e)}):tr(o,r,function(e){return st(t,e)}))&&(I(e),xe(t),C&&(e.oldKeyCode=e.keyCode,e.keyCode=0),B(t,"keyHandled",t,o,e)),l)}w?u=-.53:f?u=15:l?u=-.7:m&&(u=-1/3);var ut,ft=null;function ht(e){var t,r,n=this;n.state.focused||pt(n),w&&27==e.keyCode&&(e.returnValue=!1),R(n,e)||n.options.onKeyEvent&&n.options.onKeyEvent(n,Jr(e))||(t=e.keyCode,n.doc.sel.shift=16==t||e.shiftKey,r=ct(n,e),h&&(ft=r?t:null,!r)&&88==t&&!In&&(q?e.metaKey:e.ctrlKey)&&n.replaceSelection(""))}function dt(e){var t,r,n,i=this;R(i,e)||i.options.onKeyEvent&&i.options.onKeyEvent(i,Jr(e))||(n=e.keyCode,r=e.charCode,h&&n==ft?(ft=null,I(e)):(h&&(!e.which||e.which<10)||y)&&ct(i,e)||(n=String.fromCharCode(null==r?n:r),this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!qe(this)&&-1<this.doc.mode.electricChars.indexOf(n)&&setTimeout(S(i,function(){Ft(i,i.doc.sel.to.line,"smart")}),75),r=e,(n=tr("'"+(e=n)+"'",at(t=i),function(e){return st(t,e,!0)}))&&(I(r),xe(t),B(t,"keyHandled",t,"'"+e+"'",r)),n)||(w&&!C&&(i.display.inputHasSelection=null),Ue(i)))}function pt(e){"nocursor"!=e.options.readOnly&&(e.state.focused||(g(e,"focus",e),e.state.focused=!0,-1==e.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(e.display.wrapper.className+=" CodeMirror-focused"),Xe(e,!0)),Ke(e),xe(e))}function gt(e){e.state.focused&&(g(e,"blur",e),e.state.focused=!1,e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.doc.sel.shift=!1)},150)}function mt(r,e){var n,t,i,o,l,s;function a(){var e;null!=n.input.selectionStart&&(e=n.input.value=" "+(A(t.from,t.to)?"":n.input.value),n.prevInput=" ",n.input.selectionStart=1,n.input.selectionEnd=e.length)}function c(){var e,t;n.inputDiv.style.position="relative",n.input.style.cssText=l,C&&(n.scrollbarV.scrollTop=n.scroller.scrollTop=o),Ke(r),null!=n.input.selectionStart&&(w&&!C||a(),clearTimeout(ut),e=0,t=function(){" "==n.prevInput&&0==n.input.selectionStart?S(r,Jt.selectAll)(r):e++<10?ut=setTimeout(t,500):Xe(r)},ut=setTimeout(t,200))}R(r,e,"contextmenu")||(n=r.display,t=r.doc.sel,Ye(n,e))||(i=Ze(r,e),o=n.scroller.scrollTop,i&&!h&&(!A(t.from,t.to)&&!N(i,t.from)&&N(i,t.to)||S(r,Dt)(r.doc,i,i),l=n.input.style.cssText,n.inputDiv.style.position="absolute",n.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: white; outline: none;border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",M(r),Xe(r,!0),A(t.from,t.to)&&(n.input.value=n.prevInput=" "),w&&!C&&a(),Z?(tn(e),s=function(){F(window,"mouseup",s),setTimeout(c,20)},P(window,"mouseup",s)):setTimeout(c,50)))}var vt=d.changeEnd=function(e){return e.text?T(e.from.line+e.text.length-1,G(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};function yt(e,t,r){var n,i,o;return N(t.from,r)?(n=t.text.length-1-(t.to.line-t.from.line),r.line>t.to.line+n?(i=r.line-n,(o=e.first+e.size-1)<i?T(o,E(e,o).text.length):Nt(r,E(e,i).text.length)):r.line==t.to.line+n?Nt(r,G(t.text).length+(1==t.text.length?t.from.ch:0)+E(e,t.to.line).text.length-t.to.ch):(o=r.line-t.from.line,Nt(r,t.text[o].length+(o?0:t.from.ch)))):H(e,r)}function xt(e,n,t){var i;return t&&"object"==typeof t?{anchor:yt(e,n,t.anchor),head:yt(e,n,t.head)}:"start"==t?{anchor:n.from,head:n.from}:(i=vt(n),"around"==t?{anchor:n.from,head:i}:"end"==t?{anchor:i,head:i}:{anchor:(t=function(e){var t,r;return N(e,n.from)?e:N(n.to,e)?(t=e.line+n.text.length-(n.to.line-n.from.line)-1,r=e.ch,e.line==n.to.line&&(r+=i.ch-n.to.ch),T(t,r)):i})(e.sel.anchor),head:t(e.sel.head)})}function bt(i,e,t){e={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){this.canceled=!0}};return t&&(e.update=function(e,t,r,n){e&&(this.from=H(i,e)),t&&(this.to=H(i,t)),r&&(this.text=r),void 0!==n&&(this.origin=n)}),g(i,"beforeChange",i,e),i.cm&&g(i.cm,"beforeChange",i.cm,e),e.canceled?null:{from:e.from,to:e.to,text:e.text,origin:e.origin}}function wt(e,t,r,n){if(e.cm){if(!e.cm.curOp)return S(e.cm,wt)(e,t,r,n);if(e.cm.state.suppressEdits)return}if(!(an(e,"beforeChange")||e.cm&&an(e.cm,"beforeChange"))||(t=bt(e,t,!0))){var i=Q&&!n&&function(e,t,r){var n=null;if(e.iter(t.line,r.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var r=e.markedSpans[t].marker;!r.readOnly||n&&-1!=vn(n,r)||(n=n||[]).push(r)}}),!n)return null;for(var i=[{from:t,to:r}],o=0;o<n.length;++o)for(var l=n[o],s=l.find(),a=0;a<i.length;++a){var c,u=i[a];N(u.to,s.from)||N(s.to,u.from)||(c=[a,1],(N(u.from,s.from)||!l.inclusiveLeft&&A(u.from,s.from))&&c.push({from:u.from,to:s.from}),(N(s.to,u.to)||!l.inclusiveRight&&A(u.to,s.to))&&c.push({from:s.to,to:u.to}),i.splice.apply(i,c),a+=c.length-1)}return i}(e,t.from,t.to);if(i){for(var o=i.length-1;1<=o;--o)Ct(e,{from:i[o].from,to:i[o].to,text:[""]});i.length&&Ct(e,{from:i[0].from,to:i[0].to,text:t.text},r)}else Ct(e,t,r)}}function Ct(e,r,t){var t=xt(e,r,t),n=(jr(e,r,t,e.cm?e.cm.curOp.id:NaN),St(e,r,t,cr(e,r)),[]);Fr(e,function(e,t){t||-1!=vn(n,e.history)||(Zr(e.history,r),n.push(e.history)),St(e,r,null,cr(e,r))})}function Lt(e,t){if(!e.cm||!e.cm.state.suppressEdits){var r=e.history,n=("undo"==t?r.done:r.undone).pop();if(n)for(var i={changes:[],anchorBefore:n.anchorAfter,headBefore:n.headAfter,anchorAfter:n.anchorBefore,headAfter:n.headBefore,generation:r.generation},o=(("undo"==t?r.undone:r.done).push(i),r.generation=n.generation||++r.maxGeneration,an(e,"beforeChange")||e.cm&&an(e.cm,"beforeChange")),l=n.changes.length-1;0<=l;--l){var s=n.changes[l];if(s.origin=t,o&&!bt(e,s,!1))return void(("undo"==t?r.done:r.undone).length=0);i.changes.push(Ur(e,s));var a=l?xt(e,s,null):{anchor:n.anchorBefore,head:n.headBefore},c=(St(e,s,a,ur(e,s)),[]);Fr(e,function(e,t){t||-1!=vn(c,e.history)||(Zr(e.history,s),c.push(e.history)),St(e,s,null,ur(e,s))})}}}function kt(e,t){function r(e){return T(e.line+t,e.ch)}e.first+=t,e.cm&&b(e.cm,e.first,e.first,t),e.sel.head=r(e.sel.head),e.sel.anchor=r(e.sel.anchor),e.sel.from=r(e.sel.from),e.sel.to=r(e.sel.to)}function St(e,t,r,n){if(e.cm&&!e.cm.curOp)return S(e.cm,St)(e,t,r,n);if(t.to.line<e.first)kt(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){t.from.line<e.first&&(kt(e,i=t.text.length-1-(e.first-t.from.line)),t={from:T(e.first,0),to:T(t.to.line+i,t.to.ch),text:[G(t.text)],origin:t.origin});var i=e.lastLine();if((t=t.to.line>i?{from:t.from,to:T(i,E(e,i).text.length),text:[t.text[0]],origin:t.origin}:t).removed=Rr(e,t.from,t.to),r=r||xt(e,t,null),e.cm){var i=e.cm,o=t,l=n,s=r,a=i.doc,c=i.display,u=o.from,f=o.to,h=!1,d=u.line;if(i.options.lineWrapping||(d=v(W(a,E(a,u.line))),a.iter(d,f.line+1,function(e){if(e==c.maxLine)return h=!0})),N(a.sel.head,o.from)||N(o.to,a.sel.head)||(i.curOp.cursorActivity=!0),Wr(a,o,l,s,te(i)),i.options.lineWrapping||(a.iter(d,u.line+o.text.length,function(e){var t=se(a,e);t>c.maxLineLength&&(c.maxLine=e,c.maxLineLength=t,c.maxLineChanged=!0,h=!1)}),h&&(i.curOp.updateMaxLine=!0)),a.frontier=Math.min(a.frontier,u.line),be(i,400),l=o.text.length-(f.line-u.line)-1,b(i,u.line,f.line+1,l),an(i,"change")){s={from:u,to:f,text:o.text,removed:o.removed,origin:o.origin};if(i.curOp.textChanged){for(var p=i.curOp.textChanged;p.next;p=p.next);p.next=s}else i.curOp.textChanged=s}}else Wr(e,t,n,r)}}function Mt(e,t,r,n,i){var o;N(n=n||r,r)&&(o=n,n=r,r=o),wt(e,{from:r,to:n,text:t="string"==typeof t?On(t):t,origin:i},null)}function T(e,t){if(!(this instanceof T))return new T(e,t);this.line=e,this.ch=t}function A(e,t){return e.line==t.line&&e.ch==t.ch}function N(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function Tt(e){return T(e.line,e.ch)}function At(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function H(e,t){var r;return t.line<e.first?T(e.first,0):(r=e.first+e.size-1,t.line>r?T(r,E(e,r).text.length):Nt(t,E(e,t.line).text.length))}function Nt(e,t){var r=e.ch;return null==r||t<r?T(e.line,t):r<0?T(e.line,0):e}function Ht(e,t){return t>=e.first&&t<e.first+e.size}function D(e,t,r,n){var i,o;e.sel.shift||e.sel.extend?(i=e.sel.anchor,r&&((o=N(t,i))!=N(r,i)?(i=t,t=r):o!=N(t,r)&&(t=r)),Dt(e,i,t,n)):Dt(e,t,r||t,n),e.cm&&(e.cm.curOp.userSelChange=!0)}function Dt(e,t,r,n,i){(!i&&an(e,"beforeSelectionChange")||e.cm&&an(e.cm,"beforeSelectionChange"))&&(g(o=e,"beforeSelectionChange",o,l={anchor:l=t,head:r}),o.cm&&g(o.cm,"beforeSelectionChange",o.cm,l),l.anchor=H(o,l.anchor),l.head=H(o,l.head),r=(o=l).head,t=o.anchor);var o,l=e.sel;l.goalColumn=null,!i&&A(t,l.anchor)||(t=Et(e,t,n,"push"!=i)),!i&&A(r,l.head)||(r=Et(e,r,n,"push"!=i)),A(l.anchor,t)&&A(l.head,r)||(l.anchor=t,o=N(l.head=r,t),l.from=o?r:t,l.to=o?t:r,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=e.cm.curOp.cursorActivity=!0),B(e,"cursorActivity",e))}function Wt(e){Dt(e.doc,e.doc.sel.from,e.doc.sel.to,null,"push")}function Et(e,t,r,n){var i=!1,o=t,l=r||1;e.cantEdit=!1;e:for(;;){var s=E(e,o.line);if(s.markedSpans)for(var a=0;a<s.markedSpans.length;++a){var c=s.markedSpans[a],u=c.marker;if((null==c.from||(u.inclusiveLeft?c.from<=o.ch:c.from<o.ch))&&(null==c.to||(u.inclusiveRight?c.to>=o.ch:c.to>o.ch))){if(n&&(g(u,"beforeCursorEnter"),u.explicitlyCleared)){if(s.markedSpans){--a;continue}break}if(u.atomic){c=u.find()[l<0?"from":"to"];if(A(c,o)&&(c.ch+=l,c.ch<0?c=c.line>e.first?H(e,T(c.line-1)):null:c.ch>s.text.length&&(c=c.line<e.first+e.size-1?T(c.line+1,0):null),!c)){if(i)return n?(e.cantEdit=!0,T(e.first,0)):Et(e,t,r,!0);i=!0,c=t,l=-l}o=c;continue e}}}return o}}function Ot(e,t,r){for(null==r&&(r=0);;){var n=!1,i=k(e,t),o=zt(e,i.left,i.top-r,i.left,i.bottom+r),l=e.doc.scrollTop,s=e.doc.scrollLeft;if(null!=o.scrollTop&&(rt(e,o.scrollTop),1<Math.abs(e.doc.scrollTop-l))&&(n=!0),!(n=null!=o.scrollLeft&&(nt(e,o.scrollLeft),1<Math.abs(e.doc.scrollLeft-s))?!0:n))return i}}function zt(e,t,r,n,i){var o=e.display,l=Ie(e.display),s=o.scroller.clientHeight-un,a=o.scroller.scrollTop,c={},e=e.doc.height+ke(o),u=e-l<i,r=((r=r<0?0:r)<a?c.scrollTop=r<l?0:r:a+s<i&&(l=Math.min(r,(u?e:i)-s))!=a&&(c.scrollTop=l),o.scroller.clientWidth-un),u=o.scroller.scrollLeft,e=(t+=o.gutters.offsetWidth,n+=o.gutters.offsetWidth,o.gutters.offsetWidth),i=t<e+10;return t<u+e||i?(i&&(t=0),c.scrollLeft=Math.max(0,t-10-e)):r+u-3<n&&(c.scrollLeft=n+10-r),c}function It(e,t,r){e.curOp.updateScrollPos={scrollLeft:null==t?e.doc.scrollLeft:t,scrollTop:null==r?e.doc.scrollTop:r}}function Pt(e,t,r){var n=e.curOp.updateScrollPos||(e.curOp.updateScrollPos={scrollLeft:e.doc.scrollLeft,scrollTop:e.doc.scrollTop}),e=e.display.scroller;n.scrollTop=Math.max(0,Math.min(e.scrollHeight-e.clientHeight,n.scrollTop+r)),n.scrollLeft=Math.max(0,Math.min(e.scrollWidth-e.clientWidth,n.scrollLeft+t))}function Ft(e,t,r,n){var i,o=e.doc,l=("smart"==(r=null==r?"add":r)&&(e.doc.mode.indent?i=Ce(e,t):r="prev"),e.options.tabSize),s=E(o,t),a=dn(s.text,null,l),c=s.text.match(/^\s*/)[0];if("smart"==r&&(u=e.doc.mode.indent(i,s.text.slice(c.length),s.text))==fn){if(!n)return;r="prev"}"prev"==r?u=t>o.first?dn(E(o,t-1).text,null,l):0:"add"==r?u=a+e.options.indentUnit:"subtract"==r?u=a-e.options.indentUnit:"number"==typeof r&&(u=a+r);var u=Math.max(0,u),f="",h=0;if(e.options.indentWithTabs)for(var d=Math.floor(u/l);d;--d)h+=l,f+="\t";h<u&&(f+=gn(u-h)),f!=c&&Mt(e.doc,f,T(t,0),T(t,c.length),"+input"),s.stateAfter=null}function Bt(e,t,r){var n=t,i=t,o=e.doc;return"number"==typeof t?i=E(o,At(o,t)):n=v(t),null!=n&&r(i,n)?(b(e,n,n+1),i):null}function Rt(r,e,n,t,i){var o=e.line,l=e.ch,e=n,s=E(r,o),a=!0;function c(e){var t=(i?Kn:Un)(s,l,n,!0);if(null==t){if(e||!((e=o+n)<r.first||e>=r.first+r.size?a=!1:s=E(r,o=e)))return a=!1;l=i?(n<0?Gn:Rn)(s):n<0?s.text.length:0}else l=t;return 1}if("char"==t)c();else if("column"==t)c(!0);else if("word"==t||"group"==t)for(var u=null,f="group"==t,h=!0;!(n<0)||c(!h);h=!1){var d=s.text.charAt(l)||"\n",d=Cn(d)?"w":!f||/\s/.test(d)?null:"p";if(u&&u!=d){n<0&&(n=1,c());break}if(d&&(u=d),0<n&&!c(!h))break}t=Et(r,T(o,l),e,!0);return a||(t.hitSide=!0),t}function Gt(e,t,r,n){var i,o,l=e.doc,s=t.left;for("page"==n?(i=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),o=t.top+r*(i-(r<0?1.5:.5)*Ie(e.display))):"line"==n&&(o=0<r?t.bottom+3:t.top-3);;){var a=ze(e,s,o);if(!a.outside)break;if(r<0?o<=0:o>=l.height){a.hitSide=!0;break}o+=5*r}return a}function $t(e,t){var r=t.ch,n=t.ch;if(e){(t.xRel<0||n==e.length)&&r?--r:++n;for(var i=e.charAt(r),o=Cn(i)?Cn:/\s/.test(i)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Cn(e)};0<r&&o(e.charAt(r-1));)--r;for(;n<e.length&&o(e.charAt(n));)++n}return{from:T(t.line,r),to:T(t.line,n)}}d.Pos=T,d.prototype={constructor:d,focus:function(){window.focus(),M(this),pt(this),Ue(this)},setOption:function(e,t){var r=this.options,n=r[e];r[e]==t&&"mode"!=e||(r[e]=t,_t.hasOwnProperty(e)&&S(this,_t[e])(this,t,n))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](e)},removeKeyMap:function(e){for(var t=this.state.keyMaps,r=0;r<t.length;++r)if(t[r]==e||"string"!=typeof t[r]&&t[r].name==e)return t.splice(r,1),!0},addOverlay:S(null,function(e,t){var r=e.token?e:d.getMode(this.options,e);if(r.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:r,modeSpec:e,opaque:t&&t.opaque}),this.state.modeGen++,b(this)}),removeOverlay:S(null,function(e){for(var t=this.state.overlays,r=0;r<t.length;++r){var n=t[r].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(r,1),this.state.modeGen++,void b(this)}}),indentLine:S(null,function(e,t,r){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),Ht(this.doc,e)&&Ft(this,e,t,r)}),indentSelection:S(null,function(e){var t=this.doc.sel;if(A(t.from,t.to))return Ft(this,t.from.line,e);for(var r=t.to.line-(t.to.ch?0:1),n=t.from.line;n<=r;++n)Ft(this,n,e)}),getTokenAt:function(e,t){for(var r=this.doc,n=Ce(this,(e=H(r,e)).line,t),i=this.doc.mode,o=new ir(E(r,e.line).text,this.options.tabSize);o.pos<e.ch&&!o.eol();){o.start=o.pos;var l=i.token(o,n)}return{start:o.start,end:o.pos,string:o.current(),className:l||null,type:l||null,state:n}},getTokenTypeAt:function(e){e=H(this.doc,e);var t=Lr(this,E(this.doc,e.line)),r=0,n=(t.length-1)/2,i=e.ch;if(0==i)return t[2];for(;;){var o=r+n>>1;if((o?t[2*o-1]:0)>=i)n=o;else{if(!(t[2*o+1]<i))return t[2*o+2];r=1+o}}},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?d.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){var r;if(Yt.hasOwnProperty(t))return r=Yt[t],(e=this.getModeAt(e))[t]&&r[e[t]]||e.helperType&&r[e.helperType]||r[e.name]},getStateAfter:function(e,t){var r=this.doc;return Ce(this,(e=At(r,null==e?r.first+r.size-1:e))+1,t)},cursorCoords:function(e,t){var r=this.doc.sel,e=null==e?r.head:"object"==typeof e?H(this.doc,e):e?r.from:r.to;return k(this,e,t||"page")},charCoords:function(e,t){return Ee(this,H(this.doc,e),t||"page")},coordsChar:function(e,t){return ze(this,(e=We(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=We(this,{top:e,left:0},t||"page").top,$r(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var r=!1,n=this.doc.first+this.doc.size-1,n=(e<this.doc.first?e=this.doc.first:n<e&&(e=n,r=!0),E(this.doc,e));return De(this,E(this.doc,e),{top:0,left:0},t||"page").top+(r?n.height:0)},defaultTextHeight:function(){return Ie(this.display)},defaultCharWidth:function(){return Pe(this.display)},setGutterMarker:S(null,function(e,r,n){return Bt(this,e,function(e){var t=e.gutterMarkers||(e.gutterMarkers={});return!(t[r]=n)&&Ln(t)&&(e.gutterMarkers=null),1})}),clearGutter:S(null,function(t){var r=this,e=r.doc,n=e.first;e.iter(function(e){e.gutterMarkers&&e.gutterMarkers[t]&&(e.gutterMarkers[t]=null,b(r,n,n+1),Ln(e.gutterMarkers))&&(e.gutterMarkers=null),++n})}),addLineClass:S(null,function(e,r,n){return Bt(this,e,function(e){var t="text"==r?"textClass":"background"==r?"bgClass":"wrapClass";if(e[t]){if(new RegExp("(?:^|\\s)"+n+"(?:$|\\s)").test(e[t]))return;e[t]+=" "+n}else e[t]=n;return 1})}),removeLineClass:S(null,function(e,o,l){return Bt(this,e,function(e){var t="text"==o?"textClass":"background"==o?"bgClass":"wrapClass",r=e[t];if(r){if(null==l)e[t]=null;else{var n=r.match(new RegExp("(?:^|\\s+)"+l+"(?:$|\\s+)"));if(!n)return;var i=n.index+n[0].length;e[t]=r.slice(0,n.index)+(n.index&&i!=r.length?" ":"")+r.slice(i)||null}return 1}})}),addLineWidget:S(null,function(e,t,r){var n=this,i=new vr(n,t,r);return i.noHScroll&&(n.display.alignWidgets=!0),Bt(n,e,function(e){var t=e.widgets||(e.widgets=[]);return null==i.insertAt?t.push(i):t.splice(Math.min(t.length-1,Math.max(0,i.insertAt)),0,i),i.line=e,pr(n.doc,e)&&!i.showIfHidden||(t=_r(n,e)<n.doc.scrollTop,O(e,e.height+xr(i)),t&&Pt(n,0,i.height)),1}),i}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if("number"==typeof e){if(!Ht(this.doc,e))return null;var t=e;if(!(e=E(this.doc,e)))return null}else if(null==(t=v(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(e,t,r,n,i){var o,l,s=this.display,a=(e=k(this,H(this.doc,e))).bottom,c=e.left;t.style.position="absolute",s.sizer.appendChild(t),"over"==n?a=e.top:"above"!=n&&"near"!=n||(o=Math.max(s.wrapper.clientHeight,this.doc.height),l=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth),("above"==n||e.bottom+t.offsetHeight>o)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=o&&(a=e.bottom),c+t.offsetWidth>l&&(c=l-t.offsetWidth)),t.style.top=a+"px",t.style.left=t.style.right="","right"==i?(c=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?c=0:"middle"==i&&(c=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=c+"px"),r&&(n=this,o=a,l=(e=c)+t.offsetWidth,i=a+t.offsetHeight,null!=(e=zt(n,e,o,l,i)).scrollTop&&rt(n,e.scrollTop),null!=e.scrollLeft)&&nt(n,e.scrollLeft)},triggerOnKeyDown:S(null,ht),execCommand:function(e){return Jt[e](this)},findPosH:function(e,t,r,n){var i=1;t<0&&(i=-1,t=-t);for(var o=0,l=H(this.doc,e);o<t&&!(l=Rt(this.doc,l,i,r,n)).hitSide;++o);return l},moveH:S(null,function(e,t){var r=this.doc.sel,t=r.shift||r.extend||A(r.from,r.to)?Rt(this.doc,r.head,e,t,this.options.rtlMoveVisually):e<0?r.from:r.to;D(this.doc,t,t,e)}),deleteH:S(null,function(e,t){var r=this.doc.sel;A(r.from,r.to)?Mt(this.doc,"",r.from,Rt(this.doc,r.head,e,t,!1),"+delete"):Mt(this.doc,"",r.from,r.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(e,t,r,n){var i=1,o=n;t<0&&(i=-1,t=-t);for(var l=0,s=H(this.doc,e);l<t;++l){var a=k(this,s,"div");if(null==o?o=a.left:a.left=o,(s=Gt(this,a,i,r)).hitSide)break}return s},moveV:S(null,function(e,t){var r=this.doc.sel,n=k(this,r.head,"div"),i=(null!=r.goalColumn&&(n.left=r.goalColumn),Gt(this,n,e,t));"page"==t&&Pt(this,0,Ee(this,i,"div").top-n.top),D(this.doc,i,i,e),r.goalColumn=n.left}),toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite",""))},hasFocus:function(){return this.state.focused},scrollTo:S(null,function(e,t){It(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-un,width:e.scrollWidth-un,clientHeight:e.clientHeight-un,clientWidth:e.clientWidth-un}},scrollIntoView:S(null,function(e,t){t=t||0;var r=e="number"==typeof e?T(e,0):e,e=(e&&null==e.line||(this.curOp.scrollToPos=e?H(this.doc,e):this.doc.sel.head,this.curOp.scrollToPosMargin=t,r=k(this,this.curOp.scrollToPos)),zt(this,r.left,r.top-t,r.right,r.bottom+t));It(this,e.scrollLeft,e.scrollTop)}),setSize:S(null,function(e,t){function r(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}null!=e&&(this.display.wrapper.style.width=r(e)),null!=t&&(this.display.wrapper.style.height=r(t)),this.options.lineWrapping&&(this.display.measureLineCache.length=this.display.measureLineCachePos=0),this.curOp.forceUpdate=!0}),operation:function(e){return Ve(this,e)},refresh:S(null,function(){Ae(this),It(this,this.doc.scrollLeft,this.doc.scrollTop),b(this)}),swapDoc:S(null,function(e){var t=this.doc;return t.cm=null,Br(this,e),Ae(this),Xe(this,!0),It(this,e.scrollLeft,e.scrollTop),t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},cn(d);var _t=d.optionHandlers={},Vt=d.defaults={};function t(e,t,n,r){d.defaults[e]=t,n&&(_t[e]=r?function(e,t,r){r!=Kt&&n(e,t,r)}:n)}var Kt=d.Init={toString:function(){return"CodeMirror.Init"}},Ut=(t("value","",function(e,t){e.setValue(t)},!0),t("mode",null,function(e,t){e.doc.modeOption=t,ee(e)},!0),t("indentUnit",2,ee,!0),t("indentWithTabs",!1),t("smartIndent",!0),t("tabSize",4,function(e){ee(e),Ae(e),b(e)},!0),t("electricChars",!0),t("rtlMoveVisually",!c),t("theme","default",function(e){ie(e),oe(e)},!0),t("keyMap","default",ne),t("extraKeys",null),t("onKeyEvent",null),t("onDragEvent",null),t("lineWrapping",!1,function(e){e.options.lineWrapping?(e.display.wrapper.className+=" CodeMirror-wrap",e.display.sizer.style.minWidth=""):(e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-wrap",""),ae(e)),re(e),b(e),Ae(e),setTimeout(function(){ue(e)},100)},!0),t("gutters",[],function(e){ce(e.options),oe(e)},!0),t("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?pe(e.display)+"px":"0",e.refresh()},!0),t("coverGutterNextToScrollbar",!1,ue,!0),t("lineNumbers",!1,function(e){ce(e.options),oe(e)},!0),t("firstLineNumber",1,oe,!0),t("lineNumberFormatter",function(e){return e},oe,!0),t("showCursorWhenSelecting",!1,ye,!0),t("readOnly",!1,function(e,t){"nocursor"==t?(gt(e),e.display.input.blur()):t||Xe(e,!0)}),t("dragDrop",!0),t("cursorBlinkRate",530),t("cursorScrollMargin",0),t("cursorHeight",1),t("workTime",100),t("workDelay",100),t("flattenSpans",!0),t("pollInterval",100),t("undoDepth",40,function(e,t){e.doc.history.undoDepth=t}),t("historyEventDelay",500),t("viewportMargin",10,function(e){e.refresh()},!0),t("maxHighlightLength",1e4,function(e){ee(e),e.refresh()},!0),t("moveInputWithCursor",!0,function(e,t){t||(e.display.inputDiv.style.top=e.display.inputDiv.style.left=0)}),t("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),t("autofocus",null),d.modes={}),jt=d.mimeModes={},Xt=(d.defineMode=function(e,t){if(d.defaults.mode||"null"==e||(d.defaults.mode=e),2<arguments.length){t.dependencies=[];for(var r=2;r<arguments.length;++r)t.dependencies.push(arguments[r])}Ut[e]=t},d.defineMIME=function(e,t){jt[e]=t},d.resolveMode=function(e){if("string"==typeof e&&jt.hasOwnProperty(e))e=jt[e];else if(e&&"string"==typeof e.name&&jt.hasOwnProperty(e.name)){var t=jt[e.name];(e=yn(t,e)).name=t.name}else if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return d.resolveMode("application/xml");return"string"==typeof e?{name:e}:e||{name:"null"}},d.getMode=function(e,t){var t=d.resolveMode(t),r=Ut[t.name];if(!r)return d.getMode(e,"text/plain");var n=r(e,t);if(Xt.hasOwnProperty(t.name)){var i,o=Xt[t.name];for(i in o)o.hasOwnProperty(i)&&(n.hasOwnProperty(i)&&(n["_"+i]=n[i]),n[i]=o[i])}return n.name=t.name,n},d.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),d.defineMIME("text/plain","null"),d.modeExtensions={}),qt=(d.extendMode=function(e,t){xn(t,Xt.hasOwnProperty(e)?Xt[e]:Xt[e]={})},d.defineExtension=function(e,t){d.prototype[e]=t},d.defineDocExtension=function(e,t){p.prototype[e]=t},d.defineOption=t,[]),Yt=(d.defineInitHook=function(e){qt.push(e)},d.helpers={});function Zt(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var r,n={};for(r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function Qt(e,t,r){return!e.startState||e.startState(t,r)}d.registerHelper=function(e,t,r){Yt.hasOwnProperty(e)||(Yt[e]=d[e]={}),Yt[e][t]=r},d.isWordChar=Cn,d.copyState=Zt,d.startState=Qt,d.innerMode=function(e,t){for(;e.innerMode;){var r=e.innerMode(t);if(!r||r.mode==e)break;t=r.state,e=r.mode}return r||{mode:e,state:t}};var Jt=d.commands={selectAll:function(e){e.setSelection(T(e.firstLine(),0),T(e.lastLine()))},killLine:function(e){var t=e.getCursor(!0),r=e.getCursor(!1),n=!A(t,r);n||e.getLine(t.line).length!=t.ch?e.replaceRange("",t,n?r:T(t.line),"+delete"):e.replaceRange("",t,T(t.line+1,0),"+delete")},deleteLine:function(e){var t=e.getCursor().line;e.replaceRange("",T(t,0),T(t),"+delete")},delLineLeft:function(e){var t=e.getCursor();e.replaceRange("",T(t.line,0),t,"+delete")},undo:function(e){e.undo()},redo:function(e){e.redo()},goDocStart:function(e){e.extendSelection(T(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(T(e.lastLine()))},goLineStart:function(e){e.extendSelection($n(e,e.getCursor().line))},goLineStartSmart:function(e){var t=e.getCursor(),r=$n(e,t.line),n=e.getLineHandle(r.line),i=z(n);i&&0!=i[0].level?e.extendSelection(r):(i=Math.max(0,n.text.search(/\S/)),n=t.line==r.line&&t.ch<=i&&t.ch,e.extendSelection(T(r.line,n?0:i)))},goLineEnd:function(e){e.extendSelection(function(e,t){var r,n;for(;r=dr(n=E(e.doc,t));)t=r.find().to.line;var i=z(n),i=i?(i[0].level%2?Rn:Gn)(n):n.text.length;return T(t,i)}(e,e.getCursor().line))},goLineRight:function(e){var t=e.charCoords(e.getCursor(),"div").top+5;e.extendSelection(e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:t},"div"))},goLineLeft:function(e){var t=e.charCoords(e.getCursor(),"div").top+5;e.extendSelection(e.coordsChar({left:0,top:t},"div"))},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("\t","end","+input")},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.replaceSelection("\t","end","+input")},transposeChars:function(e){var t=e.getCursor(),r=e.getLine(t.line);0<t.ch&&t.ch<r.length-1&&e.replaceRange(r.charAt(t.ch)+r.charAt(t.ch-1),T(t.line,t.ch-1),T(t.line,t.ch+1))},newlineAndIndent:function(e){S(e,function(){e.replaceSelection("\n","end","+input"),e.indentLine(e.getCursor().line,null,!0)})()},toggleOverwrite:function(e){e.toggleOverwrite()}},n=d.keyMap={};function er(e){return"string"==typeof e?n[e]:e}function tr(s,e,a){for(var t=0;t<e.length;++t){var r=function e(t){var r=(t=er(t))[s];if(!1===r)return"stop";if(null!=r&&a(r))return!0;if(t.nofallthrough)return"stop";var n=t.fallthrough;if(null!=n){if("[object Array]"!=Object.prototype.toString.call(n))return e(n);for(var i=0,o=n.length;i<o;++i){var l=e(n[i]);if(l)return l}}return!1}(e[t]);if(r)return"stop"!=r}}function rr(e){e=Pn[e.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function nr(e,t){var r;return!(h&&34==e.keyCode&&e.char||null==(r=Pn[e.keyCode])||e.altGraphKey)&&(e.altKey&&(r="Alt-"+r),(Y?e.metaKey:e.ctrlKey)&&(r="Ctrl-"+r),(Y?e.ctrlKey:e.metaKey)&&(r="Cmd-"+r),!t&&e.shiftKey?"Shift-"+r:r)}function ir(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0}function or(e,t){this.lines=[],this.type=t,this.doc=e}function lr(r,n,i,e,t){if(e&&e.shared)return o=r,l=n,s=i,c=t,(a=xn(a=e)).shared=!1,u=[lr(o,l,s,a,c)],f=u[0],h=a.replacedWith,Fr(o,function(e){h&&(a.replacedWith=h.cloneNode(!0)),u.push(lr(e,H(e,l),H(e,s),a,c));for(var t=0;t<e.linked.length;++t)if(e.linked[t].isParent)return;f=G(u)}),new sr(u,f);var o,l,s,a,c,u,f,h;if(r.cm&&!r.cm.curOp)return S(r.cm,lr)(r,n,i,e,t);var d=new or(r,t);if("range"!=t||N(n,i)){e&&xn(e,d),d.replacedWith&&(d.collapsed=!0,d.replacedWith=_("span",[d.replacedWith],"CodeMirror-widget"),e.handleMouseEvents||(d.replacedWith.ignoreEvents=!0)),d.collapsed&&(J=!0),d.addToHistory&&jr(r,{from:n,to:i,origin:"markText"},{head:r.sel.head,anchor:r.sel.anchor},NaN);var p,g,m,v=n.line,y=0,x=r.cm;if(r.iter(v,i.line+1,function(e){x&&d.collapsed&&!x.options.lineWrapping&&W(r,e)==x.display.maxLine&&(m=!0);var t={from:null,to:null,marker:d};y+=e.text.length,v==n.line&&(t.from=n.ch,y-=n.ch),v==i.line&&(t.to=i.ch,y-=e.text.length-i.ch),d.collapsed&&(v==i.line&&(g=fr(e,i.ch)),v==n.line?p=fr(e,n.ch):O(e,0)),t=t,(e=e).markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e),++v}),d.collapsed&&r.iter(n.line,i.line+1,function(e){pr(r,e)&&O(e,0)}),d.clearOnEnter&&P(d,"beforeCursorEnter",function(){d.clear()}),d.readOnly&&(Q=!0,r.history.done.length||r.history.undone.length)&&r.clearHistory(),d.collapsed){if(p!=g)throw new Error("Inserting collapsed marker overlapping an existing one");d.size=y,d.atomic=!0}x&&(m&&(x.curOp.updateMaxLine=!0),(d.className||d.title||d.startStyle||d.endStyle||d.collapsed)&&b(x,n.line,i.line+1),d.atomic)&&Wt(x)}return d}function sr(e,t){this.markers=e,this.primary=t;for(var r=0,n=this;r<e.length;++r)e[r].parent=this,P(e[r],"clear",function(){n.clear()})}function ar(e,t){if(e)for(var r=0;r<e.length;++r){var n=e[r];if(n.marker==t)return n}}function cr(e,t){var r=Ht(e,t.from.line)&&E(e,t.from.line).markedSpans,e=Ht(e,t.to.line)&&E(e,t.to.line).markedSpans;if(!r&&!e)return null;var n=t.from.ch,i=t.to.ch,o=A(t.from,t.to),l=function(e,t,r){if(e)for(var n,i=0;i<e.length;++i){var o,l=e[i],s=l.marker;!(null==l.from||(s.inclusiveLeft?l.from<=t:l.from<t))&&("bookmark"!=s.type||l.from!=t||r&&l.marker.insertLeft)||(o=null==l.to||(s.inclusiveRight?l.to>=t:l.to>t),(n=n||[]).push({from:l.from,to:o?null:l.to,marker:s}))}return n}(r,n,o),s=function(e,t,r){if(e)for(var n,i=0;i<e.length;++i){var o,l=e[i],s=l.marker;!(null==l.to||(s.inclusiveRight?l.to>=t:l.to>t))&&("bookmark"!=s.type||l.from!=t||r&&!l.marker.insertLeft)||(o=null==l.from||(s.inclusiveLeft?l.from<=t:l.from<t),(n=n||[]).push({from:o?null:l.from-t,to:null==l.to?null:l.to-t,marker:s}))}return n}(e,i,o),a=1==t.text.length,c=G(t.text).length+(a?n:0);if(l)for(var u=0;u<l.length;++u)null==(f=l[u]).to&&((h=ar(s,f.marker))?a&&(f.to=null==h.to?null:h.to+c):f.to=n);if(s)for(var f,h,u=0;u<s.length;++u)null!=(f=s[u]).to&&(f.to+=c),null==f.from?(h=ar(l,f.marker))||(f.from=c,a&&(l=l||[]).push(f)):(f.from+=c,a&&(l=l||[]).push(f));if(a&&l){for(u=0;u<l.length;++u)null!=l[u].from&&l[u].from==l[u].to&&"bookmark"!=l[u].marker.type&&l.splice(u--,1);l.length||(l=null)}var d=[l];if(!a){var p,g=t.text.length-2;if(0<g&&l)for(u=0;u<l.length;++u)null==l[u].to&&(p=p||[]).push({from:null,to:null,marker:l[u].marker});for(u=0;u<g;++u)d.push(p);d.push(s)}return d}function ur(e,t){var r=function(e,t){var r=t["spans_"+e.id];if(!r)return null;for(var n=0,i=[];n<t.text.length;++n)i.push(function(e){if(!e)return null;for(var t,r=0;r<e.length;++r)e[r].marker.explicitlyCleared?t=t||e.slice(0,r):t&&t.push(e[r]);return t?t.length?t:null:e}(r[n]));return i}(e,t),n=cr(e,t);if(!r)return n;if(n)for(var i=0;i<r.length;++i){var o=r[i],l=n[i];if(o&&l)e:for(var s=0;s<l.length;++s){for(var a=l[s],c=0;c<o.length;++c)if(o[c].marker==a.marker)continue e;o.push(a)}else l&&(r[i]=l)}return r}function fr(e,t){var r,n=J&&e.markedSpans;if(n)for(var i,o=0;o<n.length;++o)(i=n[o]).marker.collapsed&&(null==i.from||i.from<t)&&(null==i.to||i.to>t)&&(!r||r.width<i.marker.width)&&(r=i.marker);return r}function hr(e){return fr(e,-1)}function dr(e){return fr(e,e.text.length+1)}function W(e,t){for(var r;r=hr(t);)t=E(e,r.find().from.line);return t}function pr(e,t){var r=J&&t.markedSpans;if(r)for(var n,i=0;i<r.length;++i)if((n=r[i]).marker.collapsed){if(null==n.from)return 1;if(!n.marker.replacedWith&&0==n.from&&n.marker.inclusiveLeft&&function e(t,r,n){{var i;if(null==n.to)return i=n.marker.find().to,i=E(t,i.line),e(t,i,ar(i.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==r.text.length)return!0;for(var o,l=0;l<r.markedSpans.length;++l)if((o=r.markedSpans[l]).marker.collapsed&&!o.marker.replacedWith&&o.from==n.to&&(o.marker.inclusiveLeft||n.marker.inclusiveRight)&&e(t,r,o))return!0}(e,t,n))return 1}}function gr(e){var t=e.markedSpans;if(t){for(var r=0;r<t.length;++r)t[r].marker.detachLine(e);e.markedSpans=null}}function mr(e,t){if(t){for(var r=0;r<t.length;++r)t[r].marker.attachLine(e);e.markedSpans=t}}n.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},n.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},n.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft",fallthrough:["basic","emacsy"]},n.default=q?n.macDefault:n.pcDefault,n.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},d.lookupKey=tr,d.isModifierKey=rr,d.keyName=nr,d.fromTextArea=function(t,e){if((e=e||{}).value=t.value,!e.tabindex&&t.tabindex&&(e.tabindex=t.tabindex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus){var r=document.body;try{r=document.activeElement}catch(e){}e.autofocus=r==t||null!=t.getAttribute("autofocus")&&r==document.body}function n(){t.value=s.getValue()}if(t.form&&(P(t.form,"submit",n),!e.leaveSubmitMethodAlone)){var i=t.form,o=i.submit;try{var l=i.submit=function(){n(),i.submit=o,i.submit(),i.submit=l}}catch(e){}}t.style.display="none";var s=d(function(e){t.parentNode.insertBefore(e,t.nextSibling)},e);return s.save=n,s.getTextArea=function(){return t},s.toTextArea=function(){n(),t.parentNode.removeChild(s.getWrapperElement()),t.style.display="",t.form&&(F(t.form,"submit",n),"function"==typeof t.form.submit)&&(t.form.submit=o)},s},ir.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))return++this.pos,t},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=dn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue},indentation:function(){return dn(this.string,null,this.tabSize)},match:function(e,t,r){var n;return"string"!=typeof e?(n=this.string.slice(this.pos).match(e))&&0<n.index?null:(n&&!1!==t&&(this.pos+=n[0].length),n):(n=function(e){return r?e.toLowerCase():e})(this.string.substr(this.pos,e.length))==n(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)}},d.StringStream=ir,cn(d.TextMarker=or),or.prototype.clear=function(){if(!this.explicitlyCleared){for(var e,t=this.doc.cm,r=t&&!t.curOp,n=(r&&Ge(t),an(this,"clear")&&(e=this.find())&&B(this,"clear",e.from,e.to),null),i=null,o=0;o<this.lines.length;++o){var l=this.lines[o],s=ar(l.markedSpans,this);null!=s.to&&(i=v(l)),l.markedSpans=function(e,t){for(var r,n=0;n<e.length;++n)e[n]!=t&&(r=r||[]).push(e[n]);return r}(l.markedSpans,s),null!=s.from?n=v(l):this.collapsed&&!pr(this.doc,l)&&t&&O(l,Ie(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(o=0;o<this.lines.length;++o){var a=W(t.doc,this.lines[o]),c=se(t.doc,a);c>t.display.maxLineLength&&(t.display.maxLine=a,t.display.maxLineLength=c,t.display.maxLineChanged=!0)}null!=n&&t&&b(t,n,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t)&&Wt(t),r&&$e(t)}},or.prototype.find=function(){for(var e,t,r=0;r<this.lines.length;++r){var n=this.lines[r],i=ar(n.markedSpans,this);null==i.from&&null==i.to||(n=v(n),null!=i.from&&(e=T(n,i.from)),null!=i.to&&(t=T(n,i.to)))}return"bookmark"==this.type?e:e&&{from:e,to:t}},or.prototype.changed=function(){var e=this.find(),t=this.doc.cm;if(e&&t){var r,n=E(this.doc,e.from.line);if((r=Me(r=t,n))&&(r.text=r.measure=r.markedSpans=null),e.from.line>=t.display.showingFrom&&e.from.line<t.display.showingTo){for(var i=t.display.lineDiv.firstChild;i;i=i.nextSibling)if(i.lineObj==n){i.offsetHeight!=n.height&&O(n,i.offsetHeight);break}Ve(t,function(){t.curOp.selectionChanged=t.curOp.forceUpdate=t.curOp.updateMaxLine=!0})}}},or.prototype.attachLine=function(e){var t;this.lines.length||!this.doc.cm||(t=this.doc.cm.curOp).maybeHiddenMarkers&&-1!=vn(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this),this.lines.push(e)},or.prototype.detachLine=function(e){this.lines.splice(vn(this.lines,e),1),!this.lines.length&&this.doc.cm&&((e=this.doc.cm.curOp).maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)},cn(d.SharedTextMarker=sr),sr.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();B(this,"clear")}},sr.prototype.find=function(){return this.primary.find()};var vr=d.LineWidget=function(e,t,r){if(r)for(var n in r)r.hasOwnProperty(n)&&(this[n]=r[n]);this.cm=e,this.node=t};function yr(r){return function(){var e=!this.cm.curOp;e&&Ge(this.cm);try{var t=r.apply(this,arguments)}finally{e&&$e(this.cm)}return t}}function xr(e){return null!=e.height?e.height:(e.node.parentNode&&1==e.node.parentNode.nodeType||V(e.cm.display.measure,_("div",[e.node],null,"position: relative")),e.height=e.node.offsetHeight)}cn(vr),vr.prototype.clear=yr(function(){var e=this.line.widgets,t=v(this.line);if(null!=t&&e){for(var r=0;r<e.length;++r)e[r]==this&&e.splice(r--,1);e.length||(this.line.widgets=null);var n=_r(this.cm,this.line)<this.cm.doc.scrollTop;O(this.line,Math.max(0,this.line.height-xr(this))),n&&Pt(this.cm,0,-this.height),b(this.cm,t,t+1)}}),vr.prototype.changed=yr(function(){var e=this.height,e=(this.height=null,xr(this)-e);e&&(O(this.line,this.line.height+e),e=v(this.line),b(this.cm,e,e+1))});var br=d.Line=function(e,t,r){this.text=e,mr(this,t),this.height=r?r(this):1};function wr(e,t,r,n,i){var o,l=r.flattenSpans,s=(null==l&&(l=e.options.flattenSpans),0),a=null,c=new ir(t,e.options.tabSize);for(""==t&&r.blankLine&&r.blankLine(n);!c.eol();)o=c.pos>e.options.maxHighlightLength?(l=!1,c.pos=Math.min(t.length,c.start+5e4),null):r.token(c,n),l&&a==o||(s<c.start&&i(c.start,a),s=c.start,a=o),c.start=c.pos;s<c.pos&&i(c.pos,a)}function Cr(e,t,r){var o=[e.state.modeGen];wr(e,t.text,e.doc.mode,r,function(e,t){o.push(e,t)});for(var n=0;n<e.state.overlays.length;++n){var l=e.state.overlays[n],s=1,a=0;wr(e,t.text,l.mode,!0,function(e,t){for(var r=s;a<e;){var n=o[s];e<n&&o.splice(s,1,e,o[s+1],n),s+=2,a=Math.min(e,n)}if(t)if(l.opaque)o.splice(r,s-r,e,t),s=r+2;else for(;r<s;r+=2){var i=o[r+1];o[r+1]=i?i+" "+t:t}})}return o}function Lr(e,t){return t.styles&&t.styles[0]==e.state.modeGen||(t.styles=Cr(e,t,t.stateAfter=Ce(e,v(t)))),t.styles}function kr(e,t,r){var n=e.doc.mode,i=new ir(t.text,e.options.tabSize);for(""==t.text&&n.blankLine&&n.blankLine(r);!i.eol()&&i.pos<=e.options.maxHighlightLength;)n.token(i,r),i.start=i.pos}cn(br);var Sr={};function Mr(e){return e?Sr[e]||(Sr[e]="cm-"+e.replace(/ +/g," cm-")):null}function Tr(e,t,r,n){for(var i,o=t,l=!0;i=hr(o);)o=E(e.doc,i.find().from.line);var s,a,c={pre:_("pre"),col:0,pos:0,measure:null,measuredSomething:!1,cm:e,copyWidgets:n};o.textClass&&(c.pre.className=o.textClass);do{o.text&&(l=!1),c.measure=o==t&&r,c.pos=0,c.addToken=c.measure?Hr:Nr,(w||L)&&e.getOption("lineWrapping")&&(c.addToken=function(l){function s(e){for(var t=" ",r=0;r<e.length-2;++r)t+=r%2?" ":" ";return t+=" "}return function(e,t,r,n,i,o){return l(e,t.replace(/ {3,}/,s),r,n,i,o)}}(c.addToken));var u=function(e,t,r){var n=e.markedSpans,i=e.text,o=0;if(n)for(var l,s,a,c,u,f,h=i.length,d=0,p=1,g="",m=0;;){if(m==d){s=a=c=u="",m=1/0;for(var v=f=null,y=0;y<n.length;++y){var x=n[y],b=x.marker;x.from<=d&&(null==x.to||x.to>d)?(null!=x.to&&m>x.to&&(m=x.to,a=""),b.className&&(s+=" "+b.className),b.startStyle&&x.from==d&&(c+=" "+b.startStyle),b.endStyle&&x.to==m&&(a+=" "+b.endStyle),b.title&&!u&&(u=b.title),b.collapsed&&(!f||f.marker.size<b.size)&&(f=x)):x.from>d&&m>x.from&&(m=x.from),"bookmark"==b.type&&x.from==d&&b.replacedWith&&(v=b)}if(f&&(f.from||0)==d&&(Dr(t,(null==f.to?h:f.to)-d,f.marker,null==f.from),null==f.to))return f.marker.find();v&&!f&&Dr(t,0,v)}if(h<=d)break;for(var w=Math.min(h,m);;){if(g){var C,L=d+g.length;if(f||(C=w<L?g.slice(0,w-d):g,t.addToken(t,C,l?l+s:s,c,d+C.length==m?a:"",u)),w<=L){g=g.slice(w-d),d=w;break}d=L,c=""}g=i.slice(o,o=r[p++]),l=Mr(r[p++])}}else for(var p=1;p<r.length;p+=2)t.addToken(t,i.slice(o,o=r[p]),Mr(r[p+1]))}(o,c,Lr(e,o))}while(r&&o==t&&!c.measuredSomething&&(r[0]=c.pre.appendChild(Wn(e.display.measure)),c.measuredSomething=!0),u&&(o=E(e.doc,u.to.line)),u);return!r||c.measuredSomething||r[0]||(r[0]=c.pre.appendChild(l?_("span"," "):Wn(e.display.measure))),c.pre.firstChild||pr(e.doc,t)||c.pre.appendChild(document.createTextNode(" ")),r&&w&&(n=z(o))&&(n[a=n.length-1].from==n[a].to&&--a,s=n[a],n=n[a-1],s.from+1==s.to)&&n&&s.level<n.level&&(a=r[c.pos-1])&&a.parentNode.insertBefore(a.measureRight=Wn(e.display.measure),a.nextSibling),g(e,"renderLine",e,t,c.pre),c.pre}var Ar=/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\uFEFF]/g;function Nr(e,t,r,n,i,o){if(t){if(Ar.test(t))for(var l=document.createDocumentFragment(),s=0;;){Ar.lastIndex=s;var a=Ar.exec(t),c=a?a.index-s:t.length-s;if(c&&(l.appendChild(document.createTextNode(t.slice(s,s+c))),e.col+=c),!a)break;s+=1+c,"\t"==a[0]?(c=(c=e.cm.options.tabSize)-e.col%c,l.appendChild(_("span",gn(c),"cm-tab")),e.col+=c):((u=_("span","•","cm-invalidchar")).title="\\u"+a[0].charCodeAt(0).toString(16),l.appendChild(u),e.col+=1)}else{e.col+=t.length;var l=document.createTextNode(t)}var u;if(r||n||i||e.measure)return r=r||"",n&&(r+=n),i&&(r+=i),u=_("span",[l],r),o&&(u.title=o),e.pre.appendChild(u);e.pre.appendChild(l)}}function Hr(e,t,r,n,i){for(var o=e.cm.options.lineWrapping,l=0;l<t.length;++l){var s=t.charAt(l),a=0==l,c=("\ud800"<=s&&s<"\udbff"&&l<t.length-1?(s=t.slice(l,l+2),++l):l&&o&&Hn(t,l)&&e.pre.appendChild(_("wbr")),e.measure[e.pos]),a=e.measure[e.pos]=Nr(e,s,r,a&&n,l==t.length-1&&i);c&&(a.leftSide=c.leftSide||c),w&&o&&" "==s&&l&&!/\s/.test(t.charAt(l-1))&&l<t.length-1&&!/\s/.test(t.charAt(l+1))&&(a.style.whiteSpace="normal"),e.pos+=s.length}t.length&&(e.measuredSomething=!0)}function Dr(e,t,r,n){var i,n=!n&&r.replacedWith;n&&(e.copyWidgets&&(n=n.cloneNode(!0)),e.pre.appendChild(n),e.measure)&&(t?e.measure[e.pos]=n:(i=e.measure[e.pos]=Wn(e.cm.display.measure),"bookmark"!=r.type||r.insertLeft?e.pre.insertBefore(i,n):e.pre.appendChild(i)),e.measuredSomething=!0),e.pos+=t}function Wr(e,o,t,r,l){function n(e){return t?t[e]:null}function i(e,t,r){var n,i;t=t,r=r,i=l,(n=e).text=t,n.stateAfter&&(n.stateAfter=null),n.styles&&(n.styles=null),null!=n.order&&(n.order=null),gr(n),mr(n,r),(t=i?i(n):1)!=n.height&&O(n,t),B(e,"change",e,o)}var s=o.from,a=o.to,c=o.text,u=E(e,s.line),f=E(e,a.line),h=G(c),d=n(c.length-1),p=a.line-s.line;if(0==s.ch&&0==a.ch&&""==h){for(var g=0,m=c.length-1,v=[];g<m;++g)v.push(new br(c[g],n(g),l));i(f,f.text,d),p&&e.remove(s.line,p),v.length&&e.insert(s.line,v)}else if(u==f)if(1==c.length)i(u,u.text.slice(0,s.ch)+h+u.text.slice(a.ch),d);else{for(v=[],g=1,m=c.length-1;g<m;++g)v.push(new br(c[g],n(g),l));v.push(new br(h+u.text.slice(a.ch),d,l)),i(u,u.text.slice(0,s.ch)+c[0],n(0)),e.insert(s.line+1,v)}else if(1==c.length)i(u,u.text.slice(0,s.ch)+c[0]+f.text.slice(a.ch),n(0)),e.remove(s.line+1,p);else{i(u,u.text.slice(0,s.ch)+c[0],n(0)),i(f,h+f.text.slice(a.ch),d);for(g=1,m=c.length-1,v=[];g<m;++g)v.push(new br(c[g],n(g),l));1<p&&e.remove(s.line+1,p-1),e.insert(s.line+1,v)}B(e,"change",e,o),Dt(e,r.anchor,r.head,null,!0)}function Er(e){this.lines=e,this.parent=null;for(var t=0,r=e.length,n=0;t<r;++t)e[t].parent=this,n+=e[t].height;this.height=n}function Or(e){for(var t=0,r=0,n=0,i=(this.children=e).length;n<i;++n){var o=e[n];t+=o.chunkSize(),r+=o.height,o.parent=this}this.size=t,this.height=r,this.parent=null}Er.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var r,n=e,i=e+t;n<i;++n){var o=this.lines[n];this.height-=o.height,(r=o).parent=null,gr(r),B(o,"delete")}this.lines.splice(e,t)},collapse:function(e){e.splice.apply(e,[e.length,0].concat(this.lines))},insertInner:function(e,t,r){this.height+=r,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0,i=t.length;n<i;++n)t[n].parent=this},iterN:function(e,t,r){for(var n=e+t;e<n;++e)if(r(this.lines[e]))return!0}},Or.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var r,n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(e<o){var l=Math.min(t,o-e),s=i.height;if(i.removeInner(e,l),this.height-=s-i.height,o==l&&(this.children.splice(n--,1),i.parent=null),0==(t-=l))break;e=0}else e-=o}this.size-t<25&&(this.collapse(r=[]),this.children=[new Er(r)],this.children[0].parent=this)},collapse:function(e){for(var t=0,r=this.children.length;t<r;++t)this.children[t].collapse(e)},insertInner:function(e,t,r){this.size+=t.length,this.height+=r;for(var n=0,i=this.children.length;n<i;++n){var o=this.children[n],l=o.chunkSize();if(e<=l){if(o.insertInner(e,t,r),o.lines&&50<o.lines.length){for(;50<o.lines.length;){var s=new Er(o.lines.splice(o.lines.length-25,25));o.height-=s.height,this.children.splice(n+1,0,s),s.parent=this}this.maybeSpill()}break}e-=l}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t,r=new Or(e.children.splice(e.children.length-5,5))}while(e.parent?(e.size-=r.size,e.height-=r.height,t=vn(e.parent.children,e),e.parent.children.splice(t+1,0,r)):(((t=new Or(e.children)).parent=e).children=[t,r],e=t),r.parent=e.parent,10<e.children.length);e.parent.maybeSpill()}},iterN:function(e,t,r){for(var n=0,i=this.children.length;n<i;++n){var o=this.children[n],l=o.chunkSize();if(e<l){var s=Math.min(t,l-e);if(o.iterN(e,s,r))return!0;if(0==(t-=s))break;e=0}else e-=l}}};var zr,Ir=0,p=d.Doc=function(e,t,r){if(!(this instanceof p))return new p(e,t,r);null==r&&(r=0),Or.call(this,[new Er([new br("",null)])]),this.first=r,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=Vr(),this.cleanGeneration=1,this.frontier=r;r=T(r,0);this.sel={from:r,to:r,head:r,anchor:r,shift:!1,extend:!1,goalColumn:null},this.id=++Ir,this.modeOption=t,Wr(this,{from:r,to:r,text:e="string"==typeof e?On(e):e},null,{head:r,anchor:r})},Pr=(p.prototype=yn(Or.prototype,{constructor:p,iter:function(e,t,r){r?this.iterN(e-this.first,t-e,r):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var r=0,n=0,i=t.length;n<i;++n)r+=t[n].height;this.insertInner(e-this.first,t,r)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Gr(this,this.first,this.first+this.size);return!1===e?t:t.join(e||"\n")},setValue:function(e){var t=T(this.first,0),r=this.first+this.size-1;wt(this,{from:t,to:T(r,E(this,r).text.length),text:On(e),origin:"setValue"},{head:t,anchor:t},!0)},replaceRange:function(e,t,r,n){Mt(this,e,t=H(this,t),r=r?H(this,r):t,n)},getRange:function(e,t,r){e=Rr(this,H(this,e),H(this,t));return!1===r?e:e.join(r||"\n")},getLine:function(e){e=this.getLineHandle(e);return e&&e.text},setLine:function(e,t){Ht(this,e)&&Mt(this,t,T(e,0),H(this,T(e)))},removeLine:function(e){e?Mt(this,"",H(this,T(e-1)),H(this,T(e))):Mt(this,"",T(0,0),H(this,T(1,0)))},getLineHandle:function(e){if(Ht(this,e))return E(this,e)},getLineNumber:v,getLineHandleVisualStart:function(e){return W(this,e="number"==typeof e?E(this,e):e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return H(this,e)},getCursor:function(e){var t=this.sel,e=null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||!1===e?t.to:t.from;return Tt(e)},somethingSelected:function(){return!A(this.sel.head,this.sel.anchor)},setCursor:_e(function(e,t,r){t=H(this,"number"==typeof e?T(e,t||0):e);r?D(this,t):Dt(this,t,t)}),setSelection:_e(function(e,t){Dt(this,H(this,e),H(this,t||e))}),extendSelection:_e(function(e,t){D(this,H(this,e),t&&H(this,t))}),getSelection:function(e){return this.getRange(this.sel.from,this.sel.to,e)},replaceSelection:function(e,t,r){wt(this,{from:this.sel.from,to:this.sel.to,text:On(e),origin:r},t||"around")},undo:_e(function(){Lt(this,"undo")}),redo:_e(function(){Lt(this,"redo")}),setExtending:function(e){this.sel.extend=e},historySize:function(){var e=this.history;return{undo:e.done.length,redo:e.undone.length}},clearHistory:function(){this.history=Vr(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration()},changeGeneration:function(){return this.history.lastOp=this.history.lastOrigin=null,this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Xr(this.history.done),undone:Xr(this.history.undone)}},setHistory:function(e){var t=this.history=Vr(this.history.maxGeneration);t.done=e.done.slice(0),t.undone=e.undone.slice(0)},markText:function(e,t,r){return lr(this,H(this,e),H(this,t),r,"range")},setBookmark:function(e,t){t={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft};return lr(this,e=H(this,e),e,t,"bookmark")},findMarksAt:function(e){var t=[],r=E(this,(e=H(this,e)).line).markedSpans;if(r)for(var n=0;n<r.length;++n){var i=r[n];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},getAllMarks:function(){var n=[];return this.iter(function(e){var t=e.markedSpans;if(t)for(var r=0;r<t.length;++r)null!=t[r].from&&n.push(t[r].marker)}),n},posFromIndex:function(t){var r,n=this.first;return this.iter(function(e){e=e.text.length+1;if(t<e)return r=t,!0;t-=e,++n}),H(this,T(n,r))},indexFromPos:function(e){var t=(e=H(this,e)).ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new p(Gr(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){var t=this.first,r=this.first+this.size,r=(null!=(e=e||{}).from&&e.from>t&&(t=e.from),null!=e.to&&e.to<r&&(r=e.to),new p(Gr(this,t,r),e.mode||this.modeOption,t));return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],r},unlinkDoc:function(e){if(e instanceof d&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){var r=this.linked[t];if(r.doc==e){this.linked.splice(t,1),e.unlinkDoc(this);break}}var n;e.history==this.history&&(n=[e.id],Fr(e,function(e){n.push(e.id)},!0),e.history=Vr(),e.history.done=Xr(this.history.done,n),e.history.undone=Xr(this.history.undone,n))},iterLinkedDocs:function(e){Fr(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),p.prototype.eachLine=p.prototype.iter,"iter insert remove copy getEditor".split(" "));for(zr in p.prototype)p.prototype.hasOwnProperty(zr)&&vn(Pr,zr)<0&&(d.prototype[zr]=function(e){return function(){return e.apply(this.doc,arguments)}}(p.prototype[zr]));function Fr(e,s,a){!function e(t,r,n){if(t.linked)for(var i=0;i<t.linked.length;++i){var o,l=t.linked[i];l.doc!=r&&(o=n&&l.sharedHist,!a||o)&&(s(l.doc,o),e(l.doc,t,o))}}(e,null,!0)}function Br(e,t){if(t.cm)throw new Error("This document is already in use.");re((e.doc=t).cm=e),ee(e),e.options.lineWrapping||ae(e),e.options.mode=t.modeOption,b(e)}function E(e,t){for(t-=e.first;!e.lines;)for(var r=0;;++r){var n=e.children[r],i=n.chunkSize();if(t<i){e=n;break}t-=i}return e.lines[t]}function Rr(e,t,r){var n=[],i=t.line;return e.iter(t.line,r.line+1,function(e){e=e.text;i==r.line&&(e=e.slice(0,r.ch)),i==t.line&&(e=e.slice(t.ch)),n.push(e),++i}),n}function Gr(e,t,r){var n=[];return e.iter(t,r,function(e){n.push(e.text)}),n}function O(e,t){for(var r=t-e.height,n=e;n;n=n.parent)n.height+=r}function v(e){if(null==e.parent)return null;for(var t=e.parent,r=vn(t.lines,e),n=t.parent;n;n=(t=n).parent)for(var i=0;n.children[i]!=t;++i)r+=n.children[i].chunkSize();return r+t.first}function $r(e,t){var r=e.first;e:do{for(var n=0,i=e.children.length;n<i;++n){var o=e.children[n],l=o.height;if(t<l){e=o;continue e}t-=l,r+=o.chunkSize()}return r}while(!e.lines);for(n=0,i=e.lines.length;n<i;++n){var s=e.lines[n].height;if(t<s)break;t-=s}return r+n}function _r(e,t){for(var r=0,n=(t=W(e.doc,t)).parent,i=0;i<n.lines.length;++i){var o=n.lines[i];if(o==t)break;r+=o.height}for(var l=n.parent;l;l=(n=l).parent)for(i=0;i<l.children.length;++i){var s=l.children[i];if(s==n)break;r+=s.height}return r}function z(e){var t=e.order;return t=null==t?e.order=Qn(e.text):t}function Vr(e){return{done:[],undone:[],undoDepth:1/0,lastTime:0,lastOp:null,lastOrigin:null,generation:e||1,maxGeneration:e||1}}function Kr(t,r,e,n){var i=r["spans_"+t.id],o=0;t.iter(Math.max(t.first,e),Math.min(t.first+t.size,n),function(e){e.markedSpans&&((i=i||(r["spans_"+t.id]={}))[o]=e.markedSpans),++o})}function Ur(e,t){var r={from:{line:t.from.line,ch:t.from.ch},to:vt(t),text:Rr(e,t.from,t.to)};return Kr(e,r,t.from.line,t.to.line+1),Fr(e,function(e){Kr(e,r,t.from.line,t.to.line+1)},!0),r}function jr(e,t,r,n){var i=e.history,o=(i.undone.length=0,+new Date),l=G(i.done);if(l&&(i.lastOp==n||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&i.lastTime>o-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))){var s=G(l.changes);A(t.from,t.to)&&A(t.from,s.to)?s.to=vt(t):l.changes.push(Ur(e,t)),l.anchorAfter=r.anchor,l.headAfter=r.head}else for(l={changes:[Ur(e,t)],generation:i.generation,anchorBefore:e.sel.anchor,headBefore:e.sel.head,anchorAfter:r.anchor,headAfter:r.head},i.done.push(l),i.generation=++i.maxGeneration;i.done.length>i.undoDepth;)i.done.shift();i.lastTime=o,i.lastOp=n,i.lastOrigin=t.origin}function Xr(e,t){for(var r=0,n=[];r<e.length;++r){var i=e[r],o=i.changes,l=[];n.push({changes:l,anchorBefore:i.anchorBefore,headBefore:i.headBefore,anchorAfter:i.anchorAfter,headAfter:i.headAfter});for(var s=0;s<o.length;++s){var a,c=o[s];if(l.push({from:c.from,to:c.to,text:c.text}),t)for(var u in c)(a=u.match(/^spans_(\d+)$/))&&-1<vn(t,Number(a[1]))&&(G(l)[u]=c[u],delete c[u])}}return n}function qr(e,t,r,n){r<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function Yr(e,t,r,n){for(var i=0;i<e.length;++i){for(var o=e[i],l=!0,s=0;s<o.changes.length;++s){var a=o.changes[s];if(o.copied||(a.from=Tt(a.from),a.to=Tt(a.to)),r<a.from.line)a.from.line+=n,a.to.line+=n;else if(t<=a.to.line){l=!1;break}}o.copied||(o.anchorBefore=Tt(o.anchorBefore),o.headBefore=Tt(o.headBefore),o.anchorAfter=Tt(o.anchorAfter),o.readAfter=Tt(o.headAfter),o.copied=!0),l?(qr(o.anchorBefore),qr(o.headBefore),qr(o.anchorAfter),qr(o.headAfter)):(e.splice(0,i+1),i=0)}}function Zr(e,t){var r=t.from.line,n=t.to.line,t=t.text.length-(n-r)-1;Yr(e.done,r,n,t),Yr(e.undone,r,n,t)}function Qr(){tn(this)}function Jr(e){return e.stop||(e.stop=Qr),e}function I(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function en(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function tn(e){I(e),en(e)}function rn(e){return e.target||e.srcElement}function nn(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),t=q&&e.ctrlKey&&1==t?3:t}function P(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent?e.attachEvent("on"+t,r):((e=e._handlers||(e._handlers={}))[t]||(e[t]=[])).push(r)}function F(e,t,r){if(e.removeEventListener)e.removeEventListener(t,r,!1);else if(e.detachEvent)e.detachEvent("on"+t,r);else{var n=e._handlers&&e._handlers[t];if(n)for(var i=0;i<n.length;++i)if(n[i]==r){n.splice(i,1);break}}}function g(e,t){var r=e._handlers&&e._handlers[t];if(r)for(var n=Array.prototype.slice.call(arguments,2),i=0;i<r.length;++i)r[i].apply(null,n)}cn(p),d.e_stop=tn,d.e_preventDefault=I,d.e_stopPropagation=en;var on,ln=0;function B(e,t){var r=e._handlers&&e._handlers[t];if(r){var n=Array.prototype.slice.call(arguments,2);on||(++ln,on=[],setTimeout(sn,0));for(var i=0;i<r.length;++i)on.push(function(e){return function(){e.apply(null,n)}}(r[i]))}}function R(e,t,r){return g(e,r||t.type,e,t),(null!=(r=t).defaultPrevented?r.defaultPrevented:0==r.returnValue)||t.codemirrorIgnore}function sn(){--ln;var e=on;on=null;for(var t=0;t<e.length;++t)e[t]()}function an(e,t){e=e._handlers&&e._handlers[t];return e&&0<e.length}function cn(e){e.prototype.on=function(e,t){P(this,e,t)},e.prototype.off=function(e,t){F(this,e,t)}}d.on=P,d.off=F,d.signal=g;var un=30,fn=d.Pass={toString:function(){return"CodeMirror.Pass"}};function hn(){this.id=null}function dn(e,t,r,n,i){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=n||0,l=i||0;o<t;++o)"\t"==e.charAt(o)?l+=r-l%r:++l;return l}hn.prototype={set:function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)}},d.countColumn=dn;var pn=[""];function gn(e){for(;pn.length<=e;)pn.push(G(pn)+" ");return pn[e]}function G(e){return e[e.length-1]}function mn(e){if(j)e.selectionStart=0,e.selectionEnd=e.value.length;else try{e.select()}catch(e){}}function vn(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;++r)if(e[r]==t)return r;return-1}function yn(e,t){function r(){}r.prototype=e;e=new r;return t&&xn(t,e),e}function xn(e,t){for(var r in t=t||{},e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function bn(e){for(var t=[],r=0;r<e;++r)t.push(void 0);return t}function $(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}var wn=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Cn(e){return/\w/.test(e)||""<e&&(e.toUpperCase()!=e.toLowerCase()||wn.test(e))}function Ln(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return;return 1}var kn=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/;function _(e,t,r,n){var i=document.createElement(e);if(r&&(i.className=r),n&&(i.style.cssText=n),"string"==typeof t)Mn(i,t);else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function Sn(e){for(var t=e.childNodes.length;0<t;--t)e.removeChild(e.firstChild);return e}function V(e,t){return Sn(e).appendChild(t)}function Mn(e,t){C?(e.innerHTML="",e.appendChild(document.createTextNode(t))):e.textContent=t}function K(e){return e.getBoundingClientRect()}d.replaceGetRect=function(e){K=e};var Tn,An,Nn=!C&&("draggable"in(o=_("div"))||"dragDrop"in o);function Hn(){return!1}function Dn(e){return null!=Tn?Tn:(V(e,e=_("div",null,null,"width: 50px; height: 50px; overflow-x: scroll")),(Tn=e.offsetWidth?e.offsetHeight-e.clientHeight:Tn)||0)}function Wn(e){var t;return(An=null==An&&(t=_("span","​"),V(e,_("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight)?t.offsetWidth<=1&&2<t.offsetHeight&&!U:An)?_("span","​"):_("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}f?Hn=function(e,t){return 36==e.charCodeAt(t-1)&&39==e.charCodeAt(t)}:m&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent)?Hn=function(e,t){return/\-[^ \-?]|\?[^ !\'\"\),.\-\/:;\?\]\}]/.test(e.slice(t-1,t+1))}:L&&!/Chrome\/(?:29|[3-9]\d|\d\d\d)\./.test(navigator.userAgent)&&(Hn=function(e,t){if(1<t&&45==e.charCodeAt(t-1)){if(/\w/.test(e.charAt(t-2))&&/[^\-?\.]/.test(e.charAt(t)))return!0;if(2<t&&/[\d\.,]/.test(e.charAt(t-2))&&/[\d\.,]/.test(e.charAt(t)))return!1}return/[~!#%&*)=+}\]|\"\.>,:;][({[<]|-[^\-?\.\u2010-\u201f\u2026]|\?[\w~`@#$%\^&*(_=+{[|><]|…[\w~`@#$%\^&*(_=+{[><]/.test(e.slice(t-1,t+1))});var En,On=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,r=[],n=e.length;t<=n;){var i=e.indexOf("\n",t),o=(-1==i&&(i=e.length),e.slice(t,"\r"==e.charAt(i-1)?i-1:i)),l=o.indexOf("\r");-1!=l?(r.push(o.slice(0,l)),t+=l+1):(r.push(o),t=i+1)}return r}:function(e){return e.split(/\r\n?|\n/)},zn=(d.splitLines=On,window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)}),In="oncopy"in(e=_("div"))||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy),Pn={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};d.keyNames=Pn;for(var r=0;r<10;r++)Pn[r+48]=String(r);for(r=65;r<=90;r++)Pn[r]=String.fromCharCode(r);for(r=1;r<=12;r++)Pn[r+111]=Pn[r+63235]="F"+r;function Fn(e){return e.level%2?e.to:e.from}function Bn(e){return e.level%2?e.from:e.to}function Rn(e){e=z(e);return e?Fn(e[0]):0}function Gn(e){var t=z(e);return t?Bn(G(t)):e.text.length}function $n(e,t){var r=E(e.doc,t),e=W(e.doc,r),r=(e!=r&&(t=v(e)),z(e));return T(t,r?(r[0].level%2?Gn:Rn)(e):0)}function _n(e,t){for(var r,n,i,o=0;o<e.length;++o){var l=e[o];if(l.from<t&&l.to>t)return En=null,o;if(l.from==t||l.to==t){if(null!=r)return n=e,l=l.level,i=e[r].level,n=n[0].level,l==n||i!=n&&l<i?(En=r,o):(En=o,r);r=o}}return En=null,r}function Vn(e,t,r,n){if(!n)return t+r;for(;0<(t+=r)&&kn.test(e.text.charAt(t)););return t}function Kn(e,t,r,n){var i=z(e);if(!i)return Un(e,t,r,n);for(var o=_n(i,t),l=i[o],s=Vn(e,t,l.level%2?-r:r,n);;){if(s>l.from&&s<l.to)return s;if(s==l.from||s==l.to)return _n(i,s)==o?s:0<r==(l=i[o+=r]).level%2?l.to:l.from;if(!(l=i[o+=r]))return null;s=0<r==l.level%2?Vn(e,l.to,-1,n):Vn(e,l.from,1,n)}}function Un(e,t,r,n){var i=t+r;if(n)for(;0<i&&kn.test(e.text.charAt(i));)i+=r;return i<0||i>e.text.length?null:i}jn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,Xn=/[stwN]/,qn=/[LRr]/,Yn=/[Lb1n]/,Zn=/[1n]/;var jn,Xn,qn,Yn,Zn,Qn=function(e){if(!jn.test(e))return!1;for(var t,r=e.length,n=[],i=0;i<r;++i)n.push(u=(t=e.charCodeAt(i))<=255?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL".charAt(t):1424<=t&&t<=1524?"R":1536<=t&&t<=1791?"rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr".charAt(t-1536):1792<=t&&t<=2220?"r":"L");for(var i=0,o="L";i<r;++i)"m"==(u=n[i])?n[i]=o:o=u;for(var i=0,l="L";i<r;++i)"1"==(u=n[i])&&"r"==l?n[i]="n":qn.test(u)&&"r"==(l=u)&&(n[i]="R");for(i=1,o=n[0];i<r-1;++i)"+"==(u=n[i])&&"1"==o&&"1"==n[i+1]?n[i]="1":","!=u||o!=n[i+1]||"1"!=o&&"n"!=o||(n[i]=o),o=u;for(i=0;i<r;++i)if(","==(u=n[i]))n[i]="N";else if("%"==u){for(var s=i+1;s<r&&"%"==n[s];++s);for(var a=i&&"!"==n[i-1]||s<r-1&&"1"==n[s]?"1":"N",c=i;c<s;++c)n[c]=a;i=s-1}for(i=0,l="L";i<r;++i){var u=n[i];"L"==l&&"1"==u?n[i]="L":qn.test(u)&&(l=u)}for(i=0;i<r;++i)if(Xn.test(n[i])){for(s=i+1;s<r&&Xn.test(n[s]);++s);for(a="L"==(i?n[i-1]:"L")||"L"==(s<r-1?n[s]:"L")?"L":"R",c=i;c<s;++c)n[c]=a;i=s-1}for(var f,h=[],i=0;i<r;)if(Yn.test(n[i])){var d=i;for(++i;i<r&&Yn.test(n[i]);++i);h.push({from:d,to:i,level:0})}else{var p=i,g=h.length;for(++i;i<r&&"L"!=n[i];++i);for(c=p;c<i;)if(Zn.test(n[c])){p<c&&h.splice(g,0,{from:p,to:c,level:1});var m=c;for(++c;c<i&&Zn.test(n[c]);++c);h.splice(g,0,{from:m,to:c,level:2}),p=c}else++c;p<i&&h.splice(g,0,{from:p,to:i,level:1})}return 1==h[0].level&&(f=e.match(/^\s+/))&&(h[0].from=f[0].length,h.unshift({from:0,to:f[0].length,level:0})),1==G(h).level&&(f=e.match(/\s+$/))&&(G(h).to-=f[0].length,h.push({from:r-f[0].length,to:r,level:0})),h[0].level!=G(h).level&&h.push({from:r,to:r,level:h[0].level}),h};return d.version="3.15.0",d}(),CodeMirror.defineMode("markdown",function(s,l){var n=CodeMirror.mimeModes.hasOwnProperty("text/html"),i=CodeMirror.getMode(s,n?"text/html":"text/plain"),a={html:"htmlmixed",js:"javascript",json:"application/json",c:"text/x-csrc","c++":"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp","c#":"text/x-csharp",scala:"text/x-scala"},r=function(){var e,t={},r={},n=[];for(i in CodeMirror.modes)CodeMirror.modes.propertyIsEnumerable(i)&&n.push(i);for(e=0;e<n.length;e++)t[n[e]]=n[e];var i,o,l=[];for(i in CodeMirror.mimeModes)CodeMirror.mimeModes.propertyIsEnumerable(i)&&l.push({mime:i,mode:CodeMirror.mimeModes[i]});for(e=0;e<l.length;e++)r[l[e].mime]=l[e].mime;for(o in a)(a[o]in t||a[o]in r)&&(t[o]=a[o]);return function(e){return t[e]?CodeMirror.getMode(s,t[e]):null}}(),c=(void 0===l.underscoresBreakWords&&(l.underscoresBreakWords=!0),void 0===l.fencedCodeBlocks&&(l.fencedCodeBlocks=!1),0),o=!1,u=!1,f="header",h="comment",d="quote",p="string",g="hr",m="tag",v="link",y="link",x="link",b="string",w="em",C="strong",L="emstrong",k=/^([*\-=_])(?:\s*\1){2,}\s*$/,S=/^[*\-+]\s+/,M=/^[0-9]+\.\s+/,T=/^(?:\={1,}|-{1,})$/,F=/^[^!\[\]*_\\<>` "'(]+/;function A(e,t,r){return(t.f=t.inline=r)(e,t)}function N(e,t,r){return(t.f=t.block=r)(e,t)}function H(e){return e.linkTitle=!1,e.em=!1,e.strong=!1,e.quote=!1,n||e.f!=W||(e.f=O,e.block=D),null}function D(e,t){if(!1!==t.list&&0<=t.indentationDiff?(t.indentationDiff<4&&(t.indentation-=t.indentationDiff),t.list=null):t.list=!1,4<=t.indentationDiff)return t.indentation-=4,e.skipToEnd(),h;if(e.eatSpace())return null;if("#"===e.peek()||o&&e.match(T))t.header=!0;else if(e.eat(">"))t.indentation++,t.quote=!0;else{if("["===e.peek())return A(e,t,R);if(e.match(k,!0))return g;if(e.match(S,!0)||e.match(M,!0))t.indentation+=4,t.list=!0;else if(l.fencedCodeBlocks&&e.match(/^```([\w+#]*)/,!0))return t.localMode=r(RegExp.$1),t.localMode&&(t.localState=t.localMode.startState()),N(e,t,B),h}return A(e,t,t.inline)}function W(e,t){var r=i.token(e,t.htmlState);return n&&"tag"===r&&"openTag"!==t.htmlState.type&&!t.htmlState.context&&(t.f=O,t.block=D),t.md_inside&&-1!=e.current().indexOf(">")&&(t.f=O,t.block=D,t.htmlState.context=void 0),r}function B(e,t){return e.sol()&&e.match(/^```/,!0)?(t.localMode=t.localState=null,t.f=O,t.block=D,h):t.localMode?t.localMode.token(e,t.localState):(e.skipToEnd(),h)}function E(e){var t=[];return e.strong?t.push(e.em?L:C):e.em&&t.push(w),e.linkText&&t.push(x),e.code&&t.push(h),e.header&&t.push(f),e.quote&&t.push(d),!1!==e.list&&t.push(p),t.length?t.join(" "):null}function e(e,t){if(e.match(F,!0))return E(t)}function O(e,t){var r=t.text(e,t);if(void 0!==r)return r;if(t.list)return t.list=null,p;r=e.next();if("\\"===r)e.next();else{if(t.linkTitle){t.linkTitle=!1;var n=((n="("===r?")":r)+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");if(e.match(new RegExp("^\\s*(?:[^"+n+"\\\\]+|\\\\\\\\|\\\\.)"+n),!0))return b}if("`"===r)return o=E(t),n=e.pos,e.eatWhile("`"),n=1+e.pos-n,t.code?n===c?(t.code=!1,o):E(t):(c=n,t.code=!0,E(t));if(!t.code){if("!"===r&&e.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return e.match(/\[[^\]]*\]/),t.inline=t.f=z,m;if("["===r&&e.match(/.*\](\(| ?\[)/,!1))t.linkText=!0;else{if("]"===r&&t.linkText)return n=E(t),t.linkText=!1,t.inline=t.f=z,n;if("<"===r&&e.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!0))return A(e,t,P(v,">"));if("<"===r&&e.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!0))return A(e,t,P(y,">"));if("<"===r&&e.match(/^\w/,!1))return-1!=e.string.indexOf(">")&&(n=e.string.substring(1,e.string.indexOf(">")),/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(n))&&(t.md_inside=!0),e.backUp(1),N(e,t,W);if("<"===r&&e.match(/^\/\w*?>/))return t.md_inside=!1,"tag";var i,n=!1,o=(l.underscoresBreakWords||"_"===r&&"_"!==e.peek()&&e.match(/(\w)/,!1)&&0<=(i=e.pos-2)&&"_"!==(i=e.string.charAt(i))&&i.match(/(\w)/,!1)&&(n=!0),E(t));if("*"===r||"_"===r&&!n){if(t.strong===r&&e.eat(r))return t.strong=!1,o;if(!t.strong&&e.eat(r))return t.strong=r,E(t);if(t.em===r)return t.em=!1,o;if(!t.em)t.em=r}else if(" "===r&&(e.eat("*")||e.eat("_"))){if(" "===e.peek())return E(t);e.backUp(1)}}}}return E(t)}function z(e,t){var r;return e.eatSpace()?null:"("===(r=e.next())||"["===r?A(e,t,P(b,"("===r?")":"]")):"error"}function R(e,t){return e.match(/^[^\]]*\]:/,!0)?(t.f=G,x):A(e,t,O)}function G(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),void 0===e.peek()?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),t.f=t.inline=O,b)}var I=[];function P(r,n,i){return i=i||O,function(e,t){return e.match((I[e=n]||(e=(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),I[e]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+e+")")),I[e])),t.inline=t.f=i,r}}return{startState:function(){return u=o=!1,{f:D,block:D,htmlState:CodeMirror.startState(i),indentation:0,inline:O,text:e,linkText:!1,linkTitle:!1,em:!1,strong:!1,header:!1,list:!1,quote:!1}},copyState:function(e){return{f:e.f,block:e.block,htmlState:CodeMirror.copyState(i,e.htmlState),indentation:e.indentation,localMode:e.localMode,localState:e.localMode?CodeMirror.copyState(e.localMode,e.localState):null,inline:e.inline,text:e.text,linkTitle:e.linkTitle,em:e.em,strong:e.strong,header:e.header,list:e.list,quote:e.quote,md_inside:e.md_inside}},token:function(e,t){if(e.sol()){if(e.match(/^\s*$/,!0))return o=!1,H(t);u=u&&!(o=!0),u=!0,t.header=!1,t.code=!1,t.f=t.block;var r=e.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,n=4*Math.floor((r-t.indentation)/4),n=t.indentation+(n=4<n?4:n);if(t.indentationDiff=n-t.indentation,t.indentation=n,0<r)return null}return t.f(e,t)},blankLine:H,getType:E}},"xml"),CodeMirror.defineMIME("text/x-markdown","markdown");var Showdown={extensions:{}},forEach=Showdown.forEach=function(e,t){if("function"==typeof e.forEach)e.forEach(t);else for(var r=e.length,n=0;n<r;n++)t(e[n],n,e)},stdExtName=function(e){return e.replace(/[_-]||\s/g,"").toLowerCase()};Showdown.converter=function(e){var a,c,s,t,r,n=0,i=[],o=[],l=("undefind"!=typeof module&&"undefined"!=typeof exports&&"undefind"!=typeof require&&(t=require("fs"))&&(t=t.readdirSync((__dirname||".")+"/extensions").filter(function(e){return~e.indexOf(".js")}).map(function(e){return e.replace(/\.js$/,"")}),Showdown.forEach(t,function(e){var t=stdExtName(e);Showdown.extensions[t]=require("./extensions/"+e)})),this.makeHtml=function(t){return a={},c={},s=[],t=(t=(t=(t=t.replace(/~/g,"~T")).replace(/\$/g,"~D")).replace(/\r\n/g,"\n")).replace(/\r/g,"\n"),t=(t=E(t="\n\n"+t+"\n\n")).replace(/^[ \t]+$/gm,""),Showdown.forEach(i,function(e){t=l(e,t)}),t=k(t),t=f(t),t=u(t),t=d(t),t=(t=(t=D(t)).replace(/~D/g,"$$")).replace(/~T/g,"~"),Showdown.forEach(o,function(e){t=l(e,t)}),t},e&&e.extensions&&(r=this,Showdown.forEach(e.extensions,function(e){if("function"!=typeof(e="string"==typeof e?Showdown.extensions[stdExtName(e)]:e))throw"Extension '"+e+"' could not be loaded.  It was either not found or is not a valid extension.";Showdown.forEach(e(r),function(e){e.type?"language"===e.type||"lang"===e.type?i.push(e):"output"!==e.type&&"html"!==e.type||o.push(e):o.push(e)})})),function(e,t){var r;return e.regex?(r=new RegExp(e.regex,"g"),t.replace(r,e.replace)):e.filter?e.filter(t):void 0}),u=function(e){return e=(e=(e+="~0").replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|(?=~0))/gm,function(e,t,r,n,i){return t=t.toLowerCase(),a[t]=H(r),n?n+i:(i&&(c[t]=i.replace(/"/g,"&quot;")),"")})).replace(/~0/,"")},f=function(e){return e=(e=(e=(e=(e=(e=(e=e.replace(/\n/g,"\n\n")).replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,h)).replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|style|section|header|footer|nav|article|aside)\b[^\r]*?<\/\2>[ \t]*(?=\n+)\n)/gm,h)).replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,h)).replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,h)).replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,h)).replace(/\n\n/g,"\n")},h=function(e,t){return t=(t=(t=t.replace(/\n\n/g,"\n")).replace(/^\n/,"")).replace(/\n+$/g,""),t="\n\n~K"+(s.push(t)-1)+"K\n\n"},d=function(e){e=b(e);var t=S("<hr />");return e=(e=(e=e.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,t)).replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,t)).replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,t),e=w(e),e=L(e),e=N(e),e=f(e),e=I(e)},p=function(e){return e=M(e),e=g(e),e=P(e),e=y(e),e=m(e),e=F(e),e=H(e),e=(e=A(e)).replace(/  +\n/g," <br />\n")},g=function(e){return e=e.replace(/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi,function(e){e=e.replace(/(.)<\/?code>(?=.)/g,"$1`");return O(e,"\\`*_")})},m=function(e){return e=(e=(e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,v)).replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?(?:\(.*?\).*?)?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,v)).replace(/(\[([^\[\]]+)\])()()()()()/g,v)},v=function(e,t,r,n,i,o,l,s){null==s&&(s="");n=n.toLowerCase();if(""==i)if(i="#"+(n=""==n?r.toLowerCase().replace(/ ?\n/g," "):n),null!=a[n])i=a[n],null!=c[n]&&(s=c[n]);else{if(!(-1<t.search(/\(\s*\)$/m)))return t;i=""}n='<a href="'+(i=O(i,"*_"))+'"';return""!=s&&(s=s.replace(/"/g,"&quot;"),n+=' title="'+(s=O(s,"*_"))+'"'),n+=">"+r+"</a>"},y=function(e){return e=(e=e.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,x)).replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,x)},x=function(e,t,r,n,i,o,l,s){n=n.toLowerCase(),s=(s=s)||"";if(""==i){if(i="#"+(n=""==n?r.toLowerCase().replace(/ ?\n/g," "):n),null==a[n])return t;i=a[n],null!=c[n]&&(s=c[n])}r=r.replace(/"/g,"&quot;"),t='<img src="'+(i=O(i,"*_"))+'" alt="'+r+'"';return s=s.replace(/"/g,"&quot;"),t+(' title="'+(s=O(s,"*_"))+'"')+" />"},b=function(e){function n(e){return e.replace(/[^\w]/g,"").toLowerCase()}return e=(e=(e=e.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(e,t){return S('<h1 id="'+n(t)+'">'+p(t)+"</h1>")})).replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,t){return S('<h2 id="'+n(t)+'">'+p(t)+"</h2>")})).replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(e,t,r){t=t.length;return S("<h"+t+' id="'+n(r)+'">'+p(r)+"</h"+t+">")})},w=function(e){e+="~0";var t=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return e=(e=n?e.replace(t,function(e,t,r){r=-1<r.search(/[*+-]/g)?"ul":"ol",t=t.replace(/\n{2,}/g,"\n\n\n"),t=C(t);return t="<"+r+">"+(t=t.replace(/\s+$/,""))+"</"+r+">\n"}):e.replace(/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,function(e,t,r,n){n=-1<n.search(/[*+-]/g)?"ul":"ol",r=r.replace(/\n{2,}/g,"\n\n\n");return t+"<"+n+">\n"+C(r)+"</"+n+">\n"})).replace(/~0/,"")},C=function(e){return n++,e=e.replace(/\n{2,}$/,"\n"),e=(e=(e+="~0").replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(e,t,r,n,i){return"<li>"+(i=t||-1<i.search(/\n{2,}/)?d(W(i)):(i=(i=w(W(i))).replace(/\n$/,""),p(i)))+"</li>\n"})).replace(/~0/g,""),n--,e},L=function(e){return e=(e=(e+="~0").replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(e,t,r){t=T(W(t=t));return t=(t=(t=E(t)).replace(/^\n+/g,"")).replace(/\n+$/g,""),S(t="<pre><code>"+t+"\n</code></pre>")+r})).replace(/~0/,"")},k=function(e){return e=(e=(e+="~0").replace(/(?:^|\n)```(.*)\n([\s\S]*?)\n```/g,function(e,t,r){r=T(r=r);return r=(r=(r=E(r)).replace(/^\n+/g,"")).replace(/\n+$/g,""),S(r="<pre><code"+(t?' class="'+t+'"':"")+">"+r+"\n</code></pre>")})).replace(/~0/,"")},S=function(e){return e=e.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(s.push(e)-1)+"K\n\n"},M=function(e){return e=e.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(e,t,r,n,i){return n=(n=n.replace(/^([ \t]*)/g,"")).replace(/[ \t]*$/g,""),t+"<code>"+(n=T(n))+"</code>"})},T=function(e){return e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;"),e=O(e,"*_{}[]\\",!1)},A=function(e){return e=(e=e.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>")).replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>")},N=function(e){return e=e.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(e,t){return t=(t=(t=t.replace(/^[ \t]*>[ \t]?/gm,"~0")).replace(/~0/g,"")).replace(/^[ \t]+$/gm,""),t=(t=(t=d(t)).replace(/(^|\n)/g,"$1  ")).replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(e,t){return t.replace(/^  /gm,"~0").replace(/~0/g,"")}),S("<blockquote>\n"+t+"\n</blockquote>")})},I=function(e){for(var t=(e=(e=e.replace(/^\n+/g,"")).replace(/\n+$/g,"")).split(/\n{2,}/g),r=[],n=t.length,i=0;i<n;i++){var o=t[i];0<=o.search(/~K(\d+)K/g)?r.push(o):0<=o.search(/\S/)&&(o=(o=p(o)).replace(/^([ \t]*)/g,"<p>"),r.push(o+="</p>"))}for(n=r.length,i=0;i<n;i++)for(;0<=r[i].search(/~K(\d+)K/);){var l=(l=s[RegExp.$1]).replace(/\$/g,"$$$$");r[i]=r[i].replace(/~K\d+K/,l)}return r.join("\n\n")},H=function(e){return e=(e=e.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;")).replace(/<(?![a-z\/?\$!])/gi,"&lt;")},P=function(e){return e=(e=e.replace(/\\(\\)/g,z)).replace(/\\([`*_{}\[\]()>#+-.!])/g,z)},F=function(e){return e=(e=e.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>')).replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(e,t){return B(D(t))})},B=function(e){var r=[function(e){return"&#"+e.charCodeAt(0)+";"},function(e){return"&#x"+e.charCodeAt(0).toString(16)+";"},function(e){return e}];return e=(e='<a href="'+(e=(e="mailto:"+e).replace(/./g,function(e){var t;return"@"==e?e=r[Math.floor(2*Math.random())](e):":"!=e&&(e=.9<(t=Math.random())?r[2](e):.45<t?r[1](e):r[0](e)),e}))+'">'+e+"</a>").replace(/">.+:/g,'">')},D=function(e){return e=e.replace(/~E(\d+)E/g,function(e,t){t=parseInt(t);return String.fromCharCode(t)})},W=function(e){return e=(e=e.replace(/^(\t|[ ]{1,4})/gm,"~0")).replace(/~0/g,"")},E=function(e){return e=(e=(e=(e=(e=e.replace(/\t(?=\t)/g,"    ")).replace(/\t/g,"~A~B")).replace(/~B(.+?)~A/g,function(e,t,r){for(var n=t,i=4-n.length%4,o=0;o<i;o++)n+=" ";return n})).replace(/~A/g,"    ")).replace(/~B/g,"")},O=function(e,t,r){t="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])",r&&(t="\\\\"+t),r=new RegExp(t,"g");return e=e.replace(r,z)},z=function(e,t){return"~E"+t.charCodeAt(0)+"E"}},"undefined"!=typeof module&&(module.exports=Showdown),"function"==typeof define&&define.amd&&define("showdown",function(){return Showdown}),function(i,t,o){"use strict";i(function(){var r,n;function e(){var e,t;document.getElementsByClassName("rendered-markdown")[0].innerHTML=r.makeHtml(n.getValue()),e=document.getElementsByClassName("entry-word-count")[0],(t=n.getValue()).length&&(e.innerHTML=t.match(/\S+/g).length+" words")}document.getElementById("entry-markdown")&&(r=new t.converter,n=o.fromTextArea(document.getElementById("entry-markdown"),{mode:"markdown",tabMode:"indent",lineWrapping:!0}),i(document).ready(function(){i(".entry-markdown header, .entry-preview header").click(function(e){i(".entry-markdown, .entry-preview").removeClass("active"),i(e.target).closest("section").addClass("active")}),n.on("change",function(){e()}),e(),i(".CodeMirror-scroll").on("scroll",function(e){var e=i(e.target),t=i(".entry-preview-content"),r=i(".CodeMirror-sizer"),n=i(".rendered-markdown"),r=r.height()-e.height(),n=(n.height()-t.height())/r,r=e.scrollTop()*n;t.scrollTop(r)}),i(".CodeMirror-scroll").scroll(function(){10<i(".CodeMirror-scroll").scrollTop()?i(".entry-markdown").addClass("scrolling"):i(".entry-markdown").removeClass("scrolling")}),i(".entry-preview-content").scroll(function(){10<i(".entry-preview-content").scrollTop()?i(".entry-preview").addClass("scrolling"):i(".entry-preview").removeClass("scrolling")})}))})}(jQuery,Showdown,CodeMirror);